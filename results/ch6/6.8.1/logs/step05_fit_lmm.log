[START] Step 05: Fit LMM with Domain x Time Interaction
[LOAD] Loading LMM input data...
[LOADED] step04_lmm_input.csv (1200 rows, 7 cols)
[INFO] Domains: ['Destination', 'Source', 'UID']
[INFO] Participants: 100
[INFO] Observations: 1200
[ANALYSIS] Fitting LMM with formula: theta ~ C(location) * log_TSVR
[ANALYSIS] Random effects: (1 | UID) - random intercept only
[ERROR] endog has evaluated to an array with multiple columns that has shape (1200, 900). This occurs when the variable converted to endog is non-numeric (e.g., bool or str).
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.8.1/code/step05_fit_lmm.py", line 169, in <module>
    model = smf.mixedlm(
            ^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/statsmodels/regression/mixed_linear_model.py", line 1046, in from_formula
    mod = super().from_formula(formula, data, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/statsmodels/base/model.py", line 209, in from_formula
    raise ValueError('endog has evaluated to an array with multiple '
ValueError: endog has evaluated to an array with multiple columns that has shape (1200, 900). This occurs when the variable converted to endog is non-numeric (e.g., bool or str).
[START] Step 05: Fit LMM with Domain x Time Interaction
[LOAD] Loading LMM input data...
[LOADED] step04_lmm_input.csv (800 rows, 7 cols)
[INFO] Domains: ['Destination', 'Source']
[INFO] Participants: 100
[INFO] Observations: 800
[ANALYSIS] Fitting LMM with formula: theta ~ C(location) * log_TSVR
[ANALYSIS] Random effects: (1 | UID) - random intercept only
[DONE] LMM fitting complete
[INFO] Converged: True
[INFO] AIC: 887.80
[INFO] BIC: 915.91
[EXTRACT] Extracting fixed effects coefficients...
[INFO] Number of fixed effects: 4
[INFO] Fixed effect terms: ['Intercept', 'C(location)[T.Source]', 'log_TSVR', 'C(location)[T.Source]:log_TSVR']
[EXTRACT] Fixed effects table created (4 rows)
[RESULTS] Fixed Effects:
  Intercept: coef=-0.0685, p=0.2958 
  C(location)[T.Source]: coef=0.0389, p=0.4843 
  log_TSVR: coef=-0.1379, p=0.0000 ***
  C(location)[T.Source]:log_TSVR: coef=-0.0088, p=0.5528 
[INFO] Domain x Time interaction terms found: ['C(location)[T.Source]:log_TSVR']
[HYPOTHESIS] C(location)[T.Source]:log_TSVR: p=0.5528 -> NULL (p >= 0.05)
[SAVE] Saving fixed effects table...
[SAVED] step05_lmm_coefficients.csv (4 rows, 5 cols)
[SAVE] Saving full LMM summary...
[SAVED] step05_lmm_summary.txt
[VALIDATION] Running validate_lmm_convergence...
[VALIDATION] converged: True
[VALIDATION] message: LMM converged successfully
[SUCCESS] Step 05 complete - Domain x Time interaction tested
