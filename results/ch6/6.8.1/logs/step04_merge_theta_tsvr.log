[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[ERROR] "The following id_vars or value_vars are not present in the DataFrame: ['test']"
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.8.1/code/step04_merge_theta_tsvr.py", line 175, in <module>
    df_long = pd.melt(
              ^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/reshape/melt.py", line 74, in melt
    raise KeyError(
KeyError: "The following id_vars or value_vars are not present in the DataFrame: ['test']"
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 1200 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination', 'UID']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (1200 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [PASS] Row count: 1200 rows = 400 theta rows * 3 domains
[VALIDATION] [WARN] TSVR_hours range: [1.0, 246.2] exceeds expected 0-168 but acceptable
[VALIDATION] [PASS] log_TSVR range: [0.693, 5.510] (expected max ~5.13)
[VALIDATION] [PASS] No missing TSVR_hours (0 NaN values)
[VALIDATION] [PASS] UID parsing successful (100 unique UIDs, sample: ['A010', 'A011', 'A012', 'A013', 'A014'])
[ERROR] name 'expected_congruences' is not defined
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.8.1/code/step04_merge_theta_tsvr.py", line 270, in <module>
    if actual_congruences == expected_congruences:
                             ^^^^^^^^^^^^^^^^^^^^
NameError: name 'expected_congruences' is not defined
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 1200 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination', 'UID']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (1200 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [PASS] Row count: 1200 rows = 400 theta rows * 3 domains
[VALIDATION] [WARN] TSVR_hours range: [1.0, 246.2] exceeds expected 0-168 but acceptable
[VALIDATION] [PASS] log_TSVR range: [0.693, 5.510] (expected max ~5.13)
[VALIDATION] [PASS] No missing TSVR_hours (0 NaN values)
[VALIDATION] [PASS] UID parsing successful (100 unique UIDs, sample: ['A010', 'A011', 'A012', 'A013', 'A014'])
[VALIDATION] [FAIL] Location mismatch - Expected: {'theta_Destination', 'theta_Source'}, Got: {'UID', 'Source', 'Destination'}
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 1200 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination', 'UID']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (1200 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [PASS] Row count: 1200 rows = 400 theta rows * 3 domains
[VALIDATION] [WARN] TSVR_hours range: [1.0, 246.2] exceeds expected 0-168 but acceptable
[VALIDATION] [PASS] log_TSVR range: [0.693, 5.510] (expected max ~5.13)
[VALIDATION] [PASS] No missing TSVR_hours (0 NaN values)
[VALIDATION] [PASS] UID parsing successful (100 unique UIDs, sample: ['A010', 'A011', 'A012', 'A013', 'A014'])
[VALIDATION] [PASS] Locations correct: ['Destination', 'Source']
[INFO] Summary statistics by domain:
[INFO]   Destination: N=400, theta mean=-0.532, SD=0.664
[INFO]   Source: N=400, theta mean=-0.523, SD=0.679
[ERROR] Could not convert string 'A010A010A010A010A011A011A011A011A012A012A012A012A013A013A013A013A014A014A014A014A015A015A015A015A016A016A016A016A017A017A017A017A018A018A018A018A019A019A019A019A020A020A020A020A021A021A021A021A022A022A022A022A023A023A023A023A024A024A024A024A025A025A025A025A026A026A026A026A027A027A027A027A028A028A028A028A029A029A029A029A030A030A030A030A031A031A031A031A032A032A032A032A033A033A033A033A034A034A034A034A035A035A035A035A036A036A036A036A037A037A037A037A038A038A038A038A039A039A039A039A040A040A040A040A041A041A041A041A042A042A042A042A043A043A043A043A044A044A044A044A045A045A045A045A046A046A046A046A047A047A047A047A048A048A048A048A049A049A049A049A050A050A050A050A051A051A051A051A052A052A052A052A053A053A053A053A054A054A054A054A055A055A055A055A056A056A056A056A057A057A057A057A058A058A058A058A059A059A059A059A060A060A060A060A061A061A061A061A062A062A062A062A063A063A063A063A064A064A064A064A065A065A065A065A066A066A066A066A067A067A067A067A068A068A068A068A069A069A069A069A070A070A070A070A071A071A071A071A072A072A072A072A073A073A073A073A074A074A074A074A075A075A075A075A076A076A076A076A077A077A077A077A078A078A078A078A079A079A079A079A080A080A080A080A081A081A081A081A082A082A082A082A083A083A083A083A084A084A084A084A085A085A085A085A086A086A086A086A087A087A087A087A088A088A088A088A089A089A089A089A090A090A090A090A091A091A091A091A092A092A092A092A093A093A093A093A094A094A094A094A095A095A095A095A096A096A096A096A097A097A097A097A098A098A098A098A099A099A099A099A100A100A100A100A101A101A101A101A102A102A102A102A103A103A103A103A104A104A104A104A105A105A105A105A106A106A106A106A107A107A107A107A108A108A108A108A109A109A109A109' to numeric
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.8.1/code/step04_merge_theta_tsvr.py", line 281, in <module>
    theta_mean = domain_data['theta'].mean()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/series.py", line 6570, in mean
    return NDFrame.mean(self, axis, skipna, numeric_only, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 12485, in mean
    return self._stat_function(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 12442, in _stat_function
    return self._reduce(
           ^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/series.py", line 6478, in _reduce
    return op(delegate, skipna=skipna, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/nanops.py", line 720, in nanmean
    the_sum = _ensure_numeric(the_sum)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/nanops.py", line 1701, in _ensure_numeric
    raise TypeError(f"Could not convert string '{x}' to numeric")
TypeError: Could not convert string 'A010A010A010A010A011A011A011A011A012A012A012A012A013A013A013A013A014A014A014A014A015A015A015A015A016A016A016A016A017A017A017A017A018A018A018A018A019A019A019A019A020A020A020A020A021A021A021A021A022A022A022A022A023A023A023A023A024A024A024A024A025A025A025A025A026A026A026A026A027A027A027A027A028A028A028A028A029A029A029A029A030A030A030A030A031A031A031A031A032A032A032A032A033A033A033A033A034A034A034A034A035A035A035A035A036A036A036A036A037A037A037A037A038A038A038A038A039A039A039A039A040A040A040A040A041A041A041A041A042A042A042A042A043A043A043A043A044A044A044A044A045A045A045A045A046A046A046A046A047A047A047A047A048A048A048A048A049A049A049A049A050A050A050A050A051A051A051A051A052A052A052A052A053A053A053A053A054A054A054A054A055A055A055A055A056A056A056A056A057A057A057A057A058A058A058A058A059A059A059A059A060A060A060A060A061A061A061A061A062A062A062A062A063A063A063A063A064A064A064A064A065A065A065A065A066A066A066A066A067A067A067A067A068A068A068A068A069A069A069A069A070A070A070A070A071A071A071A071A072A072A072A072A073A073A073A073A074A074A074A074A075A075A075A075A076A076A076A076A077A077A077A077A078A078A078A078A079A079A079A079A080A080A080A080A081A081A081A081A082A082A082A082A083A083A083A083A084A084A084A084A085A085A085A085A086A086A086A086A087A087A087A087A088A088A088A088A089A089A089A089A090A090A090A090A091A091A091A091A092A092A092A092A093A093A093A093A094A094A094A094A095A095A095A095A096A096A096A096A097A097A097A097A098A098A098A098A099A099A099A099A100A100A100A100A101A101A101A101A102A102A102A102A103A103A103A103A104A104A104A104A105A105A105A105A106A106A106A106A107A107A107A107A108A108A108A108A109A109A109A109' to numeric
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 1200 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination', 'UID']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (1200 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [PASS] Row count: 1200 rows = 400 theta rows * 3 domains
[VALIDATION] [WARN] TSVR_hours range: [1.0, 246.2] exceeds expected 0-168 but acceptable
[VALIDATION] [PASS] log_TSVR range: [0.693, 5.510] (expected max ~5.13)
[VALIDATION] [PASS] No missing TSVR_hours (0 NaN values)
[VALIDATION] [PASS] UID parsing successful (100 unique UIDs, sample: ['A010', 'A011', 'A012', 'A013', 'A014'])
[VALIDATION] [PASS] Locations correct: ['Destination', 'Source']
[INFO] Summary statistics by location:
[INFO]   Destination: N=400, theta mean=-0.532, SD=0.664
[INFO]   Source: N=400, theta mean=-0.523, SD=0.679
[SUCCESS] Step 4 complete - LMM input ready with TSVR time variable
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 800 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (800 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [FAIL] Row count mismatch: Expected 1200, got 800
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 800 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (800 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [PASS] Row count: 800 rows = 400 theta rows * 2 locations
[VALIDATION] [WARN] TSVR_hours range: [1.0, 246.2] exceeds expected 0-168 but acceptable
[VALIDATION] [PASS] log_TSVR range: [0.693, 5.510] (expected max ~5.13)
[VALIDATION] [PASS] No missing TSVR_hours (0 NaN values)
[VALIDATION] [PASS] UID parsing successful (100 unique UIDs, sample: ['A010', 'A011', 'A012', 'A013', 'A014'])
[VALIDATION] [PASS] Locations correct: ['Destination', 'Source']
[INFO] Summary statistics by location:
[INFO]   Destination: N=400, theta mean=-0.532, SD=0.664
[INFO]   Source: N=400, theta mean=-0.523, SD=0.679
[SUCCESS] Step 4 complete - LMM input ready with TSVR time variable
[START] Step 4: Merge Theta with TSVR Time Data
[LOAD] Loading Pass 2 theta estimates (wide format)...
[LOADED] step03_pass2_theta.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_Source', 'theta_Destination']
[LOAD] Loading TSVR time mapping...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] TSVR columns: ['composite_ID', 'UID', 'TEST', 'TSVR_hours']
[MERGE] Merging theta with TSVR on composite_ID (left join)...
[MERGED] Result: 400 rows, 6 cols
[VALIDATION] 100% merge rate - all 400 theta observations matched with TSVR
[RESHAPE] Melting wide theta format to long format...
[RESHAPED] Result: 800 rows (expected: 1200)
[INFO] Congruences: ['Source', 'Destination']
[PARSE] Extracting UID from composite_ID...
[INFO] Extracted 100 unique UIDs
[TRANSFORM] Adding time transformations for LMM...
[INFO] log_TSVR range: [0.693, 5.510]
[SAVE] Saving LMM-ready input to step04_lmm_input.csv...
[SAVED] step04_lmm_input.csv (800 rows, 7 cols)
[VALIDATION] Running inline validation checks...
[VALIDATION] [PASS] Row count: 800 rows = 400 theta rows * 2 locations
[VALIDATION] [WARN] TSVR_hours range: [1.0, 246.2] exceeds expected 0-168 but acceptable
[VALIDATION] [PASS] log_TSVR range: [0.693, 5.510] (expected max ~5.13)
[VALIDATION] [PASS] No missing TSVR_hours (0 NaN values)
[VALIDATION] [PASS] UID parsing successful (100 unique UIDs, sample: ['A010', 'A011', 'A012', 'A013', 'A014'])
[VALIDATION] [PASS] Locations correct: ['Destination', 'Source']
[INFO] Summary statistics by location:
[INFO]   Destination: N=400, theta mean=-0.532, SD=0.664
[INFO]   Source: N=400, theta mean=-0.523, SD=0.679
[SUCCESS] Step 4 complete - LMM input ready with TSVR time variable
