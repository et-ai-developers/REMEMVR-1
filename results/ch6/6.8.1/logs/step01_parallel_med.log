/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/deepirtools/data.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[START] Step 01: IRT Calibration Pass 1 (2-factor GRM on all TC_* items)
[CONFIG] Model: 2-factor GRM, 5 categories
[CONFIG] Fitting: batch_size=2048, mc_samples=1 (FAST mode), iw_samples=100
[CONFIG] Scoring: mc_samples=100 (ACCURATE mode), iw_samples=100
[LOAD] Loading input data...
[LOADED] step00_irt_input.csv (400 rows, 37 cols)
[LOADED] step00_q_matrix.csv (36 items)
[INFO] Q-matrix specifies 36 items across 3 factors
[VALIDATION] All 36 Q-matrix items found in data
[TRANSFORM] Converting wide format to long format...
[TRANSFORM] Long format created: 14400 observations (400 participants x 36 items)
[TRANSFORM] Creating factor groups from Q-matrix...
[INFO] Source: 18 items
[INFO] Destination: 18 items
[ANALYSIS] Preparing IRT tensors via prepare_irt_input_from_long...
[DONE] Tensors prepared:
  - response_matrix: torch.Size([400, 36]) (participants x items)
  - missing_mask: torch.Size([400, 36])
  - Q_matrix: torch.Size([36, 2]) (items x factors)
  - composite_ids: 400 IDs
  - item_list: 36 items
[ANALYSIS] Configuring 2-factor GRM model via configure_irt_model...

Initializing model parameters
Initialization ended in  0.02  seconds
[DONE] Model configured: 36 items, 2 factors, 5 categories, correlated=True
[ANALYSIS] Fitting GRM model via fit_irt_grm...
[CRITICAL] Using mc_samples=1 during fit (avoids timeout per RQ 6.1.1)
Fitting IRT model on cpu...

Fitting started
Epoch =        0 Iter. =        1 Cur. loss =   30.17   Intervals no change =    0Epoch =      100 Iter. =      101 Cur. loss =   25.66   Intervals no change =    0Epoch =      200 Iter. =      201 Cur. loss =   23.98   Intervals no change =    0Epoch =      300 Iter. =      301 Cur. loss =   22.70   Intervals no change =    0Epoch =      400 Iter. =      401 Cur. loss =   21.76   Intervals no change =    0Epoch =      500 Iter. =      501 Cur. loss =   21.04   Intervals no change =    0Epoch =      600 Iter. =      601 Cur. loss =   20.51   Intervals no change =    0Epoch =      700 Iter. =      701 Cur. loss =   20.06   Intervals no change =    0Epoch =      800 Iter. =      801 Cur. loss =   19.68   Intervals no change =    0Epoch =      900 Iter. =      901 Cur. loss =   19.36   Intervals no change =    0Epoch =     1000 Iter. =     1001 Cur. loss =   19.08   Intervals no change =    0Epoch =     1100 Iter. =     1101 Cur. loss =   18.82   Intervals no change =    0Epoch =     1200 Iter. =     1201 Cur. loss =   18.60   Intervals no change =    0Epoch =     1300 Iter. =     1301 Cur. loss =   18.36   Intervals no change =    0Epoch =     1400 Iter. =     1401 Cur. loss =   18.21   Intervals no change =    0Epoch =     1500 Iter. =     1501 Cur. loss =   18.06   Intervals no change =    0Epoch =     1600 Iter. =     1601 Cur. loss =   17.88   Intervals no change =    0Epoch =     1700 Iter. =     1701 Cur. loss =   17.72   Intervals no change =    0Epoch =     1800 Iter. =     1801 Cur. loss =   17.57   Intervals no change =    0Epoch =     1900 Iter. =     1901 Cur. loss =   17.45   Intervals no change =    0Epoch =     2000 Iter. =     2001 Cur. loss =   17.36   Intervals no change =    0Epoch =     2100 Iter. =     2101 Cur. loss =   17.24   Intervals no change =    0Epoch =     2200 Iter. =     2201 Cur. loss =   17.14   Intervals no change =    0Epoch =     2300 Iter. =     2301 Cur. loss =   17.04   Intervals no change =    0Epoch =     2400 Iter. =     2401 Cur. loss =   16.96   Intervals no change =    0Epoch =     2500 Iter. =     2501 Cur. loss =   16.84   Intervals no change =    0Epoch =     2600 Iter. =     2601 Cur. loss =   16.78   Intervals no change =    0Epoch =     2700 Iter. =     2701 Cur. loss =   16.72   Intervals no change =    0Epoch =     2800 Iter. =     2801 Cur. loss =   16.63   Intervals no change =    0Epoch =     2900 Iter. =     2901 Cur. loss =   16.57   Intervals no change =    0Epoch =     3000 Iter. =     3001 Cur. loss =   16.51   Intervals no change =    0Epoch =     3100 Iter. =     3101 Cur. loss =   16.48   Intervals no change =    0Epoch =     3200 Iter. =     3201 Cur. loss =   16.41   Intervals no change =    0Epoch =     3300 Iter. =     3301 Cur. loss =   16.34   Intervals no change =    0Epoch =     3400 Iter. =     3401 Cur. loss =   16.29   Intervals no change =    0Epoch =     3500 Iter. =     3501 Cur. loss =   16.26   Intervals no change =    0Epoch =     3600 Iter. =     3601 Cur. loss =   16.24   Intervals no change =    0Epoch =     3700 Iter. =     3701 Cur. loss =   16.15   Intervals no change =    0Epoch =     3800 Iter. =     3801 Cur. loss =   16.11   Intervals no change =    0Epoch =     3900 Iter. =     3901 Cur. loss =   16.11   Intervals no change =    0Epoch =     4000 Iter. =     4001 Cur. loss =   16.07   Intervals no change =    0Epoch =     4100 Iter. =     4101 Cur. loss =   16.02   Intervals no change =    0Epoch =     4200 Iter. =     4201 Cur. loss =   15.99   Intervals no change =    0Epoch =     4300 Iter. =     4301 Cur. loss =   15.96   Intervals no change =    0Epoch =     4400 Iter. =     4401 Cur. loss =   15.95   Intervals no change =    0Epoch =     4500 Iter. =     4501 Cur. loss =   15.86   Intervals no change =    0Epoch =     4600 Iter. =     4601 Cur. loss =   15.86   Intervals no change =    0Epoch =     4700 Iter. =     4701 Cur. loss =   15.85   Intervals no change =    0Epoch =     4800 Iter. =     4801 Cur. loss =   15.82   Intervals no change =    0Epoch =     4900 Iter. =     4901 Cur. loss =   15.79   Intervals no change =    0Epoch =     5000 Iter. =     5001 Cur. loss =   15.77   Intervals no change =    0Epoch =     5100 Iter. =     5101 Cur. loss =   15.76   Intervals no change =    0Epoch =     5200 Iter. =     5201 Cur. loss =   15.71   Intervals no change =    0Epoch =     5300 Iter. =     5301 Cur. loss =   15.69   Intervals no change =    0Epoch =     5400 Iter. =     5401 Cur. loss =   15.67   Intervals no change =    0Epoch =     5500 Iter. =     5501 Cur. loss =   15.67   Intervals no change =    0Epoch =     5600 Iter. =     5601 Cur. loss =   15.63   Intervals no change =    0Epoch =     5700 Iter. =     5701 Cur. loss =   15.63   Intervals no change =    0Epoch =     5800 Iter. =     5801 Cur. loss =   15.64   Intervals no change =    0Epoch =     5900 Iter. =     5901 Cur. loss =   15.57   Intervals no change =    0Epoch =     6000 Iter. =     6001 Cur. loss =   15.59   Intervals no change =    0Epoch =     6100 Iter. =     6101 Cur. loss =   15.55   Intervals no change =    0Epoch =     6200 Iter. =     6201 Cur. loss =   15.54   Intervals no change =    0Epoch =     6300 Iter. =     6301 Cur. loss =   15.53   Intervals no change =    0Epoch =     6400 Iter. =     6401 Cur. loss =   15.51   Intervals no change =    0Epoch =     6500 Iter. =     6501 Cur. loss =   15.51   Intervals no change =    0Epoch =     6600 Iter. =     6601 Cur. loss =   15.52   Intervals no change =    0Epoch =     6700 Iter. =     6701 Cur. loss =   15.47   Intervals no change =    0Epoch =     6800 Iter. =     6801 Cur. loss =   15.49   Intervals no change =    0Epoch =     6900 Iter. =     6901 Cur. loss =   15.44   Intervals no change =    0Epoch =     7000 Iter. =     7001 Cur. loss =   15.41   Intervals no change =    0Epoch =     7100 Iter. =     7101 Cur. loss =   15.46   Intervals no change =    0Epoch =     7200 Iter. =     7201 Cur. loss =   15.43   Intervals no change =    0Epoch =     7300 Iter. =     7301 Cur. loss =   15.40   Intervals no change =    0Epoch =     7400 Iter. =     7401 Cur. loss =   15.42   Intervals no change =    0Epoch =     7500 Iter. =     7501 Cur. loss =   15.38   Intervals no change =    0Epoch =     7600 Iter. =     7601 Cur. loss =   15.40   Intervals no change =    0Epoch =     7700 Iter. =     7701 Cur. loss =   15.36   Intervals no change =    1Epoch =     7800 Iter. =     7801 Cur. loss =   15.40   Intervals no change =    0Epoch =     7900 Iter. =     7901 Cur. loss =   15.37   Intervals no change =    0Epoch =     8000 Iter. =     8001 Cur. loss =   15.38   Intervals no change =    0Epoch =     8100 Iter. =     8101 Cur. loss =   15.39   Intervals no change =    1Epoch =     8200 Iter. =     8201 Cur. loss =   15.38   Intervals no change =    0Epoch =     8300 Iter. =     8301 Cur. loss =   15.36   Intervals no change =    0Epoch =     8400 Iter. =     8401 Cur. loss =   15.36   Intervals no change =    1Epoch =     8500 Iter. =     8501 Cur. loss =   15.35   Intervals no change =    0Epoch =     8600 Iter. =     8601 Cur. loss =   15.35   Intervals no change =    0Epoch =     8700 Iter. =     8701 Cur. loss =   15.29   Intervals no change =    1Epoch =     8800 Iter. =     8801 Cur. loss =   15.32   Intervals no change =    0Epoch =     8900 Iter. =     8901 Cur. loss =   15.36   Intervals no change =    1Epoch =     9000 Iter. =     9001 Cur. loss =   15.30   Intervals no change =    0Epoch =     9100 Iter. =     9101 Cur. loss =   15.33   Intervals no change =    1Epoch =     9200 Iter. =     9201 Cur. loss =   15.32   Intervals no change =    2Epoch =     9300 Iter. =     9301 Cur. loss =   15.34   Intervals no change =    0Epoch =     9400 Iter. =     9401 Cur. loss =   15.29   Intervals no change =    0Epoch =     9500 Iter. =     9501 Cur. loss =   15.26   Intervals no change =    0Epoch =     9600 Iter. =     9601 Cur. loss =   15.34   Intervals no change =    1Epoch =     9700 Iter. =     9701 Cur. loss =   15.32   Intervals no change =    2Epoch =     9800 Iter. =     9801 Cur. loss =   15.31   Intervals no change =    3Epoch =     9900 Iter. =     9901 Cur. loss =   15.30   Intervals no change =    4Epoch =    10000 Iter. =    10001 Cur. loss =   15.30   Intervals no change =    5Epoch =    10100 Iter. =    10101 Cur. loss =   15.30   Intervals no change =    0Epoch =    10200 Iter. =    10201 Cur. loss =   15.28   Intervals no change =    1Epoch =    10300 Iter. =    10301 Cur. loss =   15.33   Intervals no change =    2Epoch =    10400 Iter. =    10401 Cur. loss =   15.32   Intervals no change =    0Epoch =    10500 Iter. =    10501 Cur. loss =   15.28   Intervals no change =    1Epoch =    10600 Iter. =    10601 Cur. loss =   15.33   Intervals no change =    2Epoch =    10700 Iter. =    10701 Cur. loss =   15.28   Intervals no change =    3Epoch =    10800 Iter. =    10801 Cur. loss =   15.33   Intervals no change =    4Epoch =    10900 Iter. =    10901 Cur. loss =   15.30   Intervals no change =    5Epoch =    11000 Iter. =    11001 Cur. loss =   15.29   Intervals no change =    6Epoch =    11100 Iter. =    11101 Cur. loss =   15.34   Intervals no change =    7Epoch =    11200 Iter. =    11201 Cur. loss =   15.31   Intervals no change =    8Epoch =    11300 Iter. =    11301 Cur. loss =   15.32   Intervals no change =    9Epoch =    11400 Iter. =    11401 Cur. loss =   15.31   Intervals no change =   10Epoch =    11500 Iter. =    11501 Cur. loss =   15.29   Intervals no change =   11Epoch =    11600 Iter. =    11601 Cur. loss =   15.32   Intervals no change =   12Epoch =    11700 Iter. =    11701 Cur. loss =   15.30   Intervals no change =   13Epoch =    11800 Iter. =    11801 Cur. loss =   15.31   Intervals no change =   14Epoch =    11900 Iter. =    11901 Cur. loss =   15.31   Intervals no change =   15Epoch =    12000 Iter. =    12001 Cur. loss =   15.33   Intervals no change =    0Epoch =    12100 Iter. =    12101 Cur. loss =   15.30   Intervals no change =    1Epoch =    12200 Iter. =    12201 Cur. loss =   15.34   Intervals no change =    2Epoch =    12300 Iter. =    12301 Cur. loss =   15.26   Intervals no change =    3Epoch =    12400 Iter. =    12401 Cur. loss =   15.28   Intervals no change =    4Epoch =    12500 Iter. =    12501 Cur. loss =   15.31   Intervals no change =    5Epoch =    12600 Iter. =    12601 Cur. loss =   15.34   Intervals no change =    6Epoch =    12700 Iter. =    12701 Cur. loss =   15.31   Intervals no change =    7Epoch =    12800 Iter. =    12801 Cur. loss =   15.33   Intervals no change =    8Epoch =    12900 Iter. =    12901 Cur. loss =   15.33   Intervals no change =    9Epoch =    13000 Iter. =    13001 Cur. loss =   15.32   Intervals no change =   10Epoch =    13100 Iter. =    13101 Cur. loss =   15.30   Intervals no change =   11Epoch =    13200 Iter. =    13201 Cur. loss =   15.33   Intervals no change =   12Epoch =    13300 Iter. =    13301 Cur. loss =   15.34   Intervals no change =   13Epoch =    13400 Iter. =    13401 Cur. loss =   15.35   Intervals no change =   14Epoch =    13500 Iter. =    13501 Cur. loss =   15.30   Intervals no change =   15Epoch =    13600 Iter. =    13601 Cur. loss =   15.30   Intervals no change =   16Epoch =    13700 Iter. =    13701 Cur. loss =   15.32   Intervals no change =   17Epoch =    13800 Iter. =    13801 Cur. loss =   15.32   Intervals no change =   18Epoch =    13900 Iter. =    13901 Cur. loss =   15.31   Intervals no change =   19Epoch =    14000 Iter. =    14001 Cur. loss =   15.33   Intervals no change =   20Epoch =    14100 Iter. =    14101 Cur. loss =   15.32   Intervals no change =   21Epoch =    14200 Iter. =    14201 Cur. loss =   15.29   Intervals no change =   22Epoch =    14300 Iter. =    14301 Cur. loss =   15.33   Intervals no change =   23Epoch =    14400 Iter. =    14401 Cur. loss =   15.34   Intervals no change =   24Epoch =    14500 Iter. =    14501 Cur. loss =   15.32   Intervals no change =   25Epoch =    14600 Iter. =    14601 Cur. loss =   15.34   Intervals no change =   26Epoch =    14700 Iter. =    14701 Cur. loss =   15.34   Intervals no change =   27Epoch =    14800 Iter. =    14801 Cur. loss =   15.33   Intervals no change =   28Epoch =    14900 Iter. =    14901 Cur. loss =   15.33   Intervals no change =   29Epoch =    15000 Iter. =    15001 Cur. loss =   15.32   Intervals no change =   30Epoch =    15100 Iter. =    15101 Cur. loss =   15.33   Intervals no change =   31Epoch =    15200 Iter. =    15201 Cur. loss =   15.33   Intervals no change =   32Epoch =    15300 Iter. =    15301 Cur. loss =   15.34   Intervals no change =   33Epoch =    15400 Iter. =    15401 Cur. loss =   15.36   Intervals no change =   34Epoch =    15500 Iter. =    15501 Cur. loss =   15.26   Intervals no change =   35Epoch =    15600 Iter. =    15601 Cur. loss =   15.30   Intervals no change =   36Epoch =    15700 Iter. =    15701 Cur. loss =   15.32   Intervals no change =   37Epoch =    15800 Iter. =    15801 Cur. loss =   15.34   Intervals no change =   38Epoch =    15900 Iter. =    15901 Cur. loss =   15.33   Intervals no change =   39Epoch =    16000 Iter. =    16001 Cur. loss =   15.27   Intervals no change =   40Epoch =    16100 Iter. =    16101 Cur. loss =   15.31   Intervals no change =   41Epoch =    16200 Iter. =    16201 Cur. loss =   15.29   Intervals no change =   42Epoch =    16300 Iter. =    16301 Cur. loss =   15.29   Intervals no change =   43Epoch =    16400 Iter. =    16401 Cur. loss =   15.33   Intervals no change =   44Epoch =    16500 Iter. =    16501 Cur. loss =   15.31   Intervals no change =   45Epoch =    16600 Iter. =    16601 Cur. loss =   15.32   Intervals no change =   46Epoch =    16700 Iter. =    16701 Cur. loss =   15.34   Intervals no change =   47Epoch =    16800 Iter. =    16801 Cur. loss =   15.33   Intervals no change =   48Epoch =    16900 Iter. =    16901 Cur. loss =   15.26   Intervals no change =   49Epoch =    17000 Iter. =    17001 Cur. loss =   15.33   Intervals no change =   50Epoch =    17100 Iter. =    17101 Cur. loss =   15.33   Intervals no change =   51Epoch =    17200 Iter. =    17201 Cur. loss =   15.32   Intervals no change =   52Epoch =    17300 Iter. =    17301 Cur. loss =   15.35   Intervals no change =   53Epoch =    17400 Iter. =    17401 Cur. loss =   15.31   Intervals no change =   54Epoch =    17500 Iter. =    17501 Cur. loss =   15.33   Intervals no change =   55Epoch =    17600 Iter. =    17601 Cur. loss =   15.30   Intervals no change =   56Epoch =    17700 Iter. =    17701 Cur. loss =   15.30   Intervals no change =   57Epoch =    17800 Iter. =    17801 Cur. loss =   15.36   Intervals no change =   58Epoch =    17900 Iter. =    17901 Cur. loss =   15.32   Intervals no change =   59Epoch =    18000 Iter. =    18001 Cur. loss =   15.37   Intervals no change =   60Epoch =    18100 Iter. =    18101 Cur. loss =   15.34   Intervals no change =   61Epoch =    18200 Iter. =    18201 Cur. loss =   15.31   Intervals no change =   62Epoch =    18300 Iter. =    18301 Cur. loss =   15.32   Intervals no change =   63Epoch =    18400 Iter. =    18401 Cur. loss =   15.29   Intervals no change =   64Epoch =    18500 Iter. =    18501 Cur. loss =   15.29   Intervals no change =   65Epoch =    18600 Iter. =    18601 Cur. loss =   15.34   Intervals no change =   66Epoch =    18700 Iter. =    18701 Cur. loss =   15.32   Intervals no change =   67Epoch =    18800 Iter. =    18801 Cur. loss =   15.32   Intervals no change =   68Epoch =    18900 Iter. =    18901 Cur. loss =   15.31   Intervals no change =   69Epoch =    19000 Iter. =    19001 Cur. loss =   15.35   Intervals no change =   70Epoch =    19100 Iter. =    19101 Cur. loss =   15.34   Intervals no change =   71Epoch =    19200 Iter. =    19201 Cur. loss =   15.32   Intervals no change =   72Epoch =    19300 Iter. =    19301 Cur. loss =   15.31   Intervals no change =   73Epoch =    19400 Iter. =    19401 Cur. loss =   15.25   Intervals no change =   74Epoch =    19500 Iter. =    19501 Cur. loss =   15.33   Intervals no change =   75Epoch =    19600 Iter. =    19601 Cur. loss =   15.32   Intervals no change =   76Epoch =    19700 Iter. =    19701 Cur. loss =   15.32   Intervals no change =   77Epoch =    19800 Iter. =    19801 Cur. loss =   15.31   Intervals no change =   78Epoch =    19900 Iter. =    19901 Cur. loss =   15.31   Intervals no change =   79Epoch =    20000 Iter. =    20001 Cur. loss =   15.35   Intervals no change =   80Epoch =    20100 Iter. =    20101 Cur. loss =   15.34   Intervals no change =   81Epoch =    20200 Iter. =    20201 Cur. loss =   15.34   Intervals no change =   82Epoch =    20300 Iter. =    20301 Cur. loss =   15.32   Intervals no change =   83Epoch =    20400 Iter. =    20401 Cur. loss =   15.30   Intervals no change =   84Epoch =    20500 Iter. =    20501 Cur. loss =   15.36   Intervals no change =   85Epoch =    20600 Iter. =    20601 Cur. loss =   15.35   Intervals no change =   86Epoch =    20700 Iter. =    20701 Cur. loss =   15.35   Intervals no change =   87Epoch =    20800 Iter. =    20801 Cur. loss =   15.32   Intervals no change =   88Epoch =    20900 Iter. =    20901 Cur. loss =   15.32   Intervals no change =   89Epoch =    21000 Iter. =    21001 Cur. loss =   15.33   Intervals no change =   90Epoch =    21100 Iter. =    21101 Cur. loss =   15.32   Intervals no change =   91Epoch =    21200 Iter. =    21201 Cur. loss =   15.31   Intervals no change =   92Epoch =    21300 Iter. =    21301 Cur. loss =   15.34   Intervals no change =   93Epoch =    21400 Iter. =    21401 Cur. loss =   15.31   Intervals no change =   94Epoch =    21500 Iter. =    21501 Cur. loss =   15.34   Intervals no change =   95Epoch =    21600 Iter. =    21601 Cur. loss =   15.33   Intervals no change =   96Epoch =    21700 Iter. =    21701 Cur. loss =   15.32   Intervals no change =   97Epoch =    21800 Iter. =    21801 Cur. loss =   15.30   Intervals no change =   98Epoch =    21900 Iter. =    21901 Cur. loss =   15.32   Intervals no change =   99Epoch =    22000 Iter. =    22001 Cur. loss =   15.32   Intervals no change =  100
Fitting ended in  73934.45  seconds
IRT model fitting complete.
[DONE] Model fitting complete
[ANALYSIS] Extracting theta scores via extract_theta_from_irt...
[CRITICAL] Using mc_samples=100 during scoring (accurate theta estimates per RQ 6.1.1)
[DONE] Theta extraction complete: 400 participants x 2 factors
[TRANSFORM] Reconstructing composite_ID from UID and test...
[TRANSFORM] Wide format: 400 rows, 3 columns
[ANALYSIS] Extracting item parameters via extract_parameters_from_irt...
[DONE] Parameter extraction complete: 36 items
[INFO] Parameter columns: ['item_name', 'Difficulty', 'Overall_Discrimination', 'Discrim_Source', 'Discrim_Destination']
[SAVE] Saving Pass 1 outputs...
[SAVED] step01_pass1_item_params.csv (36 items, 5 cols)
[SAVED] step01_pass1_theta.csv (400 rows, 3 cols)
[VALIDATION] Running validation checks...
[VALIDATION] Checking parameter bounds...
[VALIDATION] Discrimination: min=2.461, max=4.519
[VALIDATION] Difficulty (b): min=0.064, max=0.560
[PASS] Parameter bounds valid
[VALIDATION] Checking for NaN parameters...
[PASS] No NaN parameters
[VALIDATION] Checking theta estimates...
[VALIDATION] Theta: min=-2.362, max=0.550
[PASS] Theta estimates valid
[VALIDATION] Checking output row counts...
[PASS] Output row counts correct (items=36, theta=400)
[SUCCESS] Step 01 complete - All validations passed
[SUMMARY] Pass 1 calibrated 36 items for 400 participants
[NEXT] Run Step 02 to purify items using quality thresholds (a >= 0.4, |b| <= 3.0)
