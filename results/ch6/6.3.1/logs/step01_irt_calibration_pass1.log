[START] Step 01: IRT Calibration Pass 1 (3-factor GRM on all TC_* items)
[CONFIG] Model: 3-factor GRM, 5 categories
[CONFIG] Fitting: batch_size=2048, mc_samples=1 (FAST mode), iw_samples=1
[CONFIG] Scoring: mc_samples=1 (ACCURATE mode), iw_samples=1
[LOAD] Loading input data...
[LOADED] step00_irt_input.csv (400 rows, 73 cols)
[LOADED] step00_q_matrix.csv (72 items)
[INFO] Q-matrix specifies 72 items across 3 factors
[VALIDATION] All 72 Q-matrix items found in data
[TRANSFORM] Converting wide format to long format...
[TRANSFORM] Long format created: 28800 observations (400 participants x 72 items)
[TRANSFORM] Creating factor groups from Q-matrix...
[INFO] What: 18 items
[INFO] Where: 36 items
[INFO] When: 18 items
[ANALYSIS] Preparing IRT tensors via prepare_irt_input_from_long...
[DONE] Tensors prepared:
  - response_matrix: torch.Size([400, 72]) (participants x items)
  - missing_mask: torch.Size([400, 72])
  - Q_matrix: torch.Size([72, 3]) (items x factors)
  - composite_ids: 400 IDs
  - item_list: 72 items
[ANALYSIS] Configuring 3-factor GRM model via configure_irt_model...
[DONE] Model configured: 72 items, 3 factors, 5 categories, correlated=True
[ANALYSIS] Fitting GRM model via fit_irt_grm...
[CRITICAL] Using mc_samples=1 during fit (avoids timeout per RQ 6.1.1)
[DONE] Model fitting complete
[ANALYSIS] Extracting theta scores via extract_theta_from_irt...
[CRITICAL] Using mc_samples=100 during scoring (accurate theta estimates per RQ 6.1.1)
[DONE] Theta extraction complete: 400 participants x 3 factors
[TRANSFORM] Reconstructing composite_ID from UID and test...
[TRANSFORM] Wide format: 400 rows, 4 columns
[ANALYSIS] Extracting item parameters via extract_parameters_from_irt...
[DONE] Parameter extraction complete: 72 items
[INFO] Parameter columns: ['item_name', 'Difficulty', 'Overall_Discrimination', 'Discrim_What', 'Discrim_Where', 'Discrim_When']
[SAVE] Saving Pass 1 outputs...
[SAVED] step01_pass1_item_params.csv (72 items, 6 cols)
[SAVED] step01_pass1_theta.csv (400 rows, 4 cols)
[VALIDATION] Running validation checks...
[VALIDATION] Checking parameter bounds...
[VALIDATION] Discrimination: min=2.066, max=5.816
[VALIDATION] Difficulty (b): min=-0.007, max=1.117
[PASS] Parameter bounds valid
[VALIDATION] Checking for NaN parameters...
[PASS] No NaN parameters
[VALIDATION] Checking theta estimates...
[VALIDATION] Theta: min=-2.338, max=0.633
[PASS] Theta estimates valid
[VALIDATION] Checking output row counts...
[PASS] Output row counts correct (items=72, theta=400)
[SUCCESS] Step 01 complete - All validations passed
[SUMMARY] Pass 1 calibrated 72 items for 400 participants
[NEXT] Run Step 02 to purify items using quality thresholds (a >= 0.4, |b| <= 3.0)
[START] Step 01: IRT Calibration Pass 1 (3-factor GRM on all TC_* items)
[CONFIG] Model: 3-factor GRM, 5 categories
[CONFIG] Fitting: batch_size=2048, mc_samples=1 (FAST mode), iw_samples=100
[CONFIG] Scoring: mc_samples=100 (ACCURATE mode), iw_samples=100
[LOAD] Loading input data...
[LOADED] step00_irt_input.csv (400 rows, 73 cols)
[LOADED] step00_q_matrix.csv (72 items)
[INFO] Q-matrix specifies 72 items across 3 factors
[VALIDATION] All 72 Q-matrix items found in data
[TRANSFORM] Converting wide format to long format...
[TRANSFORM] Long format created: 28800 observations (400 participants x 72 items)
[TRANSFORM] Creating factor groups from Q-matrix...
[INFO] What: 18 items
[INFO] Where: 36 items
[INFO] When: 18 items
[ANALYSIS] Preparing IRT tensors via prepare_irt_input_from_long...
[DONE] Tensors prepared:
  - response_matrix: torch.Size([400, 72]) (participants x items)
  - missing_mask: torch.Size([400, 72])
  - Q_matrix: torch.Size([72, 3]) (items x factors)
  - composite_ids: 400 IDs
  - item_list: 72 items
[ANALYSIS] Configuring 3-factor GRM model via configure_irt_model...
[DONE] Model configured: 72 items, 3 factors, 5 categories, correlated=True
[ANALYSIS] Fitting GRM model via fit_irt_grm...
[CRITICAL] Using mc_samples=1 during fit (avoids timeout per RQ 6.1.1)
[DONE] Model fitting complete
[ANALYSIS] Extracting theta scores via extract_theta_from_irt...
[CRITICAL] Using mc_samples=100 during scoring (accurate theta estimates per RQ 6.1.1)
[DONE] Theta extraction complete: 400 participants x 3 factors
[TRANSFORM] Reconstructing composite_ID from UID and test...
[TRANSFORM] Wide format: 400 rows, 4 columns
[ANALYSIS] Extracting item parameters via extract_parameters_from_irt...
[DONE] Parameter extraction complete: 72 items
[INFO] Parameter columns: ['item_name', 'Difficulty', 'Overall_Discrimination', 'Discrim_What', 'Discrim_Where', 'Discrim_When']
[SAVE] Saving Pass 1 outputs...
[SAVED] step01_pass1_item_params.csv (72 items, 6 cols)
[SAVED] step01_pass1_theta.csv (400 rows, 4 cols)
[VALIDATION] Running validation checks...
[VALIDATION] Checking parameter bounds...
[VALIDATION] Discrimination: min=2.032, max=5.834
[VALIDATION] Difficulty (b): min=0.007, max=1.167
[PASS] Parameter bounds valid
[VALIDATION] Checking for NaN parameters...
[PASS] No NaN parameters
[VALIDATION] Checking theta estimates...
[VALIDATION] Theta: min=-2.701, max=0.552
[PASS] Theta estimates valid
[VALIDATION] Checking output row counts...
[PASS] Output row counts correct (items=72, theta=400)
[SUCCESS] Step 01 complete - All validations passed
[SUMMARY] Pass 1 calibrated 72 items for 400 participants
[NEXT] Run Step 02 to purify items using quality thresholds (a >= 0.4, |b| <= 3.0)
