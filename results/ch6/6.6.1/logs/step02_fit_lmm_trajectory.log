[START] Step 02: Fit LMM for HCE Trajectory
[LOAD] Loading input data...
[LOADED] step01_hce_rates.csv (400 rows, 6 cols)
[INFO] Using columns: ['UID', 'TEST', 'TSVR', 'HCE_rate']
[INFO] Observations: 400 (Expected: 400 = 100 participants × 4 tests)
[INFO] HCE_rate range: [0.0000, 0.2778]
[INFO] TSVR range: [1.00, 246.24] hours
[ANALYSIS] Fitting LMM: HCE_rate ~ TSVR + (TSVR | UID)...
[ANALYSIS] Formula components:
[ANALYSIS]   Fixed effects: Intercept + TSVR (population-level trajectory)
[ANALYSIS]   Random effects: (TSVR | UID) (individual intercepts and slopes)
[ANALYSIS]   Groups: UID (participant-level clustering)
[ANALYSIS]   Method: REML=True (variance estimation)
[PREP] Preparing theta_scores (without tsvr) and tsvr_data (with tsvr)...
[PREP] theta_scores columns: ['UID', 'Test', 'composite_ID', 'theta', 'n_HCE', 'n_total']
[PREP] theta_scores shape: (400, 6)
[PREP] tsvr_data columns: ['UID', 'Test', 'tsvr', 'composite_ID']
[PREP] tsvr_data shape: (400, 4)
[PREP] Example composite_IDs: ['A010_T1', 'A010_T2', 'A010_T3']
/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/statsmodels/regression/mixed_linear_model.py:2237: ConvergenceWarning: The MLE may be on the boundary of the parameter space.
  warnings.warn(msg, ConvergenceWarning)

============================================================
LMM WITH TSVR TIME VARIABLE (Decision D070)
============================================================

[1/5] Parsing composite_IDs...
  Theta scores: 400 rows
  TSVR data: 400 rows

[2/5] Merging theta scores with TSVR data...
  ✓ All 400 rows have TSVR data

[3/5] Converting TSVR hours to days...
  TSVR range: 1.0h - 246.2h
  Days range: 0.04 - 10.26 days

[4/5] Preparing long-format data for LMM...
  LMM data shape: (400, 5)
  Unique UIDs: 100
  Unique Domains: 1 (['Memory'])

[5/5] Fitting Linear Mixed Model...
  Formula: Theta ~ Days
  Random effects: ~Days
  Grouping: UID

============================================================
LMM FIT COMPLETE
============================================================
Log-Likelihood: 728.55
AIC: nan
BIC: nan

[DONE] LMM fitting complete
[INFO] Convergence status: True
[INFO] Number of observations: 400
[INFO] Number of groups: 100
[SAVE] Saving model summary...
[SAVED] step02_hce_lmm.txt (1009 bytes)
[INFO] Fixed Effects:
[INFO]   Intercept: 0.049828
[INFO]   Days: -0.003005
[INFO]   Group Var: 1.500225
[INFO]   Group x Days Cov: -0.082009
[INFO]   Days Var: 0.011708
[INFO] Random Effects Variances:
[INFO]   Group (UID) Var: 0.001352
[INFO]   Group x TSVR Var: 0.000011
[VALIDATION] Running validate_lmm_convergence...
[VALIDATION] Converged: True
[VALIDATION] Message: LMM converged successfully
[VALIDATION] Additional checks:
[VALIDATION]   Random effects variance > 0: True
[VALIDATION]   All fixed effects finite: True
[VALIDATION]   Observations >= 100: True (n=400)
[VALIDATION]   Residuals normal (KS p > 0.001): True (p=0.0018)
[VALIDATION] PASS: All validation checks passed
[SUCCESS] Step 02 complete
