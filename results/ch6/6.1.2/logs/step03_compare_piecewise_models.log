[START] Step 03: Compare Piecewise Models
[LOAD] Loading input data from step01_piecewise_input.csv...
[LOADED] step01_piecewise_input.csv (400 rows, 9 cols)
[INFO] Theta range: [-2.241, 0.491]
[INFO] Segment distribution: Early=196, Late=204
[ANALYSIS] Fitting continuous model...
[INFO] Formula: theta_confidence ~ TSVR_hours
[INFO] Random effects: ~TSVR_hours
[ERROR] "['Theta'] not in index"
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.1.2/code/step03_compare_piecewise_models.py", line 125, in <module>
    continuous_model = fit_lmm_trajectory_tsvr(
                       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/tools/analysis_lmm.py", line 1139, in fit_lmm_trajectory_tsvr
    lmm_data = merged[['UID', 'Test', 'Domain', 'Theta', 'Days']].copy()
               ~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Theta'] not in index"
