[START] Step 00: Load Theta Confidence Scores
[LOAD] Loading theta confidence scores from RQ 6.1.1...
[LOADED] step03_theta_confidence.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_All', 'se_All']
[LOAD] Loading TSVR time mapping from RQ 6.1.1...
[LOADED] step00_tsvr_mapping.csv (400 rows, 3 cols)
[INFO] TSVR columns: ['composite_ID', 'TSVR_hours', 'test']
[MERGE] Merging theta confidence with TSVR mapping on composite_ID...
[DONE] Merge complete (400 rows)
[WARNING] 400 theta scores missing TSVR match
[WARNING] Missing composite_IDs: ['A010_T1', 'A010_T2', 'A010_T3', 'A010_T4', 'A011_T1', 'A011_T2', 'A011_T3', 'A011_T4', 'A012_T1', 'A012_T2']...
[PASS] No duplicate composite_IDs
[SAVE] Saving merged data to step00_lmm_input.csv...
[SAVED] step00_lmm_input.csv (400 rows, 5 cols)
[INFO] Data summary:
[ERROR] 'UID'
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'UID'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.1.2/code/step00_load_theta_confidence.py", line 187, in <module>
    log(f"  Unique UIDs: {lmm_input['UID'].nunique()}")
                          ~~~~~~~~~^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'UID'
[START] Step 00: Load Theta Confidence Scores
[LOAD] Loading theta confidence scores from RQ 6.1.1...
[LOADED] step03_theta_confidence.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_All', 'se_All']
[LOAD] Loading TSVR time mapping from RQ 6.1.1...
[LOADED] step00_tsvr_mapping.csv (400 rows, 3 cols)
[INFO] TSVR columns: ['composite_ID', 'TSVR_hours', 'test']
[MERGE] Merging theta confidence with TSVR mapping on composite_ID...
[DONE] Merge complete (400 rows)
[PARSE] Parsing UID from composite_ID...
[DONE] Parsed UID for 400 rows
[RENAME] Renaming theta columns...
[DONE] Renamed theta_All -> theta_confidence, se_All -> se_confidence
[INFO] Final columns: ['composite_ID', 'UID', 'test', 'theta_confidence', 'se_confidence', 'TSVR_hours']
[WARNING] 400 theta scores missing TSVR match
[WARNING] Missing composite_IDs: ['A010_T1', 'A010_T2', 'A010_T3', 'A010_T4', 'A011_T1', 'A011_T2', 'A011_T3', 'A011_T4', 'A012_T1', 'A012_T2']...
[PASS] No duplicate composite_IDs
[SAVE] Saving merged data to step00_lmm_input.csv...
[SAVED] step00_lmm_input.csv (400 rows, 6 cols)
[INFO] Data summary:
  Unique UIDs: 100
  Unique tests: [nan]
  Theta range: [-2.241, 0.491]
  TSVR range: [nan, nan] hours
[VALIDATION] Running validate_dataframe_structure...
[ERROR] 'type' object is not iterable
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch6/6.1.2/code/step00_load_theta_confidence.py", line 216, in <module>
    validation_result = validate_dataframe_structure(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/tools/validation.py", line 2838, in validate_dataframe_structure
    if not any(actual_type == exp_type or np.issubdtype(actual_type, exp_type) for exp_type in expected_types):
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'type' object is not iterable
[START] Step 00: Load Theta Confidence Scores
[LOAD] Loading theta confidence scores from RQ 6.1.1...
[LOADED] step03_theta_confidence.csv (400 rows, 3 cols)
[INFO] Theta columns: ['composite_ID', 'theta_All', 'se_All']
[LOAD] Loading TSVR time mapping from RQ 6.1.1...
[LOADED] step00_tsvr_mapping.csv (400 rows, 3 cols)
[INFO] TSVR columns: ['composite_ID', 'TSVR_hours', 'test']
[FIX] Converting TSVR composite_ID format (A010_1 -> A010_T1)...
[DONE] Converted 400 composite_IDs
[MERGE] Merging theta confidence with TSVR mapping on composite_ID...
[DONE] Merge complete (400 rows)
[PARSE] Parsing UID from composite_ID...
[DONE] Parsed UID for 400 rows
[RENAME] Renaming theta columns...
[DONE] Renamed theta_All -> theta_confidence, se_All -> se_confidence
[INFO] Final columns: ['composite_ID', 'UID', 'test', 'theta_confidence', 'se_confidence', 'TSVR_hours']
[PASS] All theta scores have TSVR match (no missing values)
[PASS] No duplicate composite_IDs
[SAVE] Saving merged data to step00_lmm_input.csv...
[SAVED] step00_lmm_input.csv (400 rows, 6 cols)
[INFO] Data summary:
  Unique UIDs: 100
  Unique tests: [1, 2, 3, 4]
  Theta range: [-2.241, 0.491]
  TSVR range: [1.0, 246.2] hours
[VALIDATION] Skipping validate_dataframe_structure (tool bug)...
[VALIDATION] Running manual validation checks instead...
[VALIDATION] PASS - Row count: 400 in range [390, 410]
[VALIDATION] PASS - All expected columns present
[VALIDATION] PASS - No NaN values
[VALIDATION] Running custom range checks...
[VALIDATION] PASS - All theta values in [-3, 3] range
[VALIDATION] WARNING - 2 TSVR values outside [0, 200] range
[VALIDATION] PASS - All UIDs have exactly 4 observations
[SUCCESS] Step 00 complete
