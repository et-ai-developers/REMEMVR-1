[START] Step 06: Compute Post-hoc Pairwise Contrasts
RQ Directory: /home/etai/projects/REMEMVR/results/ch5/rq3

[LOAD] Loading best LMM model from Step 5...
[LOADED] Best LMM model from /home/etai/projects/REMEMVR/results/ch5/rq3/data/step05_lmm_fitted_model.pkl
  AIC: 2346.60
  N observations: 1200
  N groups: 100
[LOADED] Fixed effects reference from /home/etai/projects/REMEMVR/results/ch5/rq3/data/step05_fixed_effects.csv
  Fixed effects: 9 terms

[ANALYSIS] Computing pairwise contrasts (Decision D068)...
  Comparisons: ['cued_recall-free_recall', 'recognition-free_recall', 'recognition-cued_recall']
  Family-wise alpha: 0.05
  Bonferroni-corrected alpha: 0.0167

[ERROR] 'sig_uncorrected'
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/rq3/code/step06_compute_post_hoc_contrasts.py", line 197, in <module>
    contrasts = compute_contrasts_pairwise(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/tools/analysis_lmm.py", line 828, in compute_contrasts_pairwise
    print(f"  Significant (uncorrected alpha=0.05): {df_contrasts['sig_uncorrected'].sum()}/{k}")
                                                     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'sig_uncorrected'
[START] Step 06: Compute Post-hoc Pairwise Contrasts
RQ Directory: /home/etai/projects/REMEMVR/results/ch5/rq3

[LOAD] Loading best LMM model from Step 5...
[LOADED] Best LMM model from /home/etai/projects/REMEMVR/results/ch5/rq3/data/step05_lmm_fitted_model.pkl
  AIC: 2346.60
  N observations: 1200
  N groups: 100
[LOADED] Fixed effects reference from /home/etai/projects/REMEMVR/results/ch5/rq3/data/step05_fixed_effects.csv
  Fixed effects: 9 terms

[ANALYSIS] Computing pairwise contrasts (Decision D068)...
  Comparisons: ['Cued_Recall-Free_Recall', 'Recognition-Free_Recall', 'Recognition-Cued_Recall']
  Family-wise alpha: 0.05
  Bonferroni-corrected alpha: 0.0167

============================================================
POST-HOC PAIRWISE CONTRASTS (Decision D068)
============================================================
Family-wise alpha: 0.05
Number of comparisons: 3
Bonferroni-corrected alpha: 0.0167

Available coefficient names:
  Intercept
  C(Factor, Treatment('Free_Recall'))[T.Cued_Recall]
  C(Factor, Treatment('Free_Recall'))[T.Recognition]
  log_Days
  log_Days:C(Factor, Treatment('Free_Recall'))[T.Cued_Recall]
  log_Days:C(Factor, Treatment('Free_Recall'))[T.Recognition]
  Group Var
  Group x log_Days Cov
  log_Days Var

Detected factor name: Factor
Detected reference level: Free_Recall

  Processing: Cued_Recall vs Free_Recall
    Found direct coefficient: C(Factor, Treatment('Free_Recall'))[T.Cued_Recall]

  Processing: Recognition vs Free_Recall
    Found direct coefficient: C(Factor, Treatment('Free_Recall'))[T.Recognition]

  Processing: Recognition vs Cued_Recall
    Using delta method: C(Factor, Treatment('Free_Recall'))[T.Recognition] - C(Factor, Treatment('Free_Recall'))[T.Cued_Recall]

Results:
  Significant (uncorrected alpha=0.05): 2/3
  Significant (corrected alpha=0.0167): 2/3
============================================================

[DONE] Pairwise contrasts computed
  Significant (uncorrected): 2/3
  Significant (Bonferroni): 2/3

[ANALYSIS] Computing effect sizes (Cohen's f-squared)...
[DONE] Effect sizes computed
  Total effects: 5

[SAVED] /home/etai/projects/REMEMVR/results/ch5/rq3/results/step06_post_hoc_contrasts.csv
  Rows: 3, Columns: 9
[SAVED] /home/etai/projects/REMEMVR/results/ch5/rq3/results/step06_effect_sizes.csv
  Rows: 5, Columns: 3

[VALIDATION] Running validation checks...
[VALIDATION] Convergence: PASS
[VALIDATION] Message: LMM converged successfully
[VALIDATION] All contrast validation checks passed

============================================================
STEP 06 SUMMARY: Post-hoc Pairwise Contrasts
============================================================

Pairwise Contrasts (Decision D068 - Dual p-value reporting):
  Cued_Recall-Free_Recall: beta=0.0234, z=0.35, p_unc=0.7257, p_cor=1.0000
  Recognition-Free_Recall: beta=0.2099, z=3.15, p_unc=0.0016*, p_cor=0.0048**
  Recognition-Cued_Recall: beta=0.1865, z=2.80, p_unc=0.0051*, p_cor=0.0152**

Effect Sizes (Cohen's f-squared):
  C(Factor, Treatment('Free_Recall'))[T.Cued_Recall]: f^2=0.0001 (negligible)
  C(Factor, Treatment('Free_Recall'))[T.Recognition]: f^2=0.0083 (negligible)
  log_Days: f^2=0.0666 (small)
  log_Days:C(Factor, Treatment('Free_Recall'))[T.Cued_Recall]: f^2=0.0008 (negligible)
  log_Days:C(Factor, Treatment('Free_Recall'))[T.Recognition]: f^2=0.0051 (negligible)

============================================================
[SUCCESS] Step 06 complete
