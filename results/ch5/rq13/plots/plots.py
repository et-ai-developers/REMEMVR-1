#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Plotting script for RQ 5.13 - Between-Person Variance in Forgetting Rates

GENERATED BY: rq_plots agent (v4.0.0)
DATE: 2025-11-30
PURPOSE: Document plotting approach for RQ 5.13

SPECIAL CASE: PLOTS CREATED DURING ANALYSIS (NOT SEPARATE PLOTTING PHASE)

For RQ 5.13, all plots were generated DURING the analysis execution (Step 5),
NOT in a separate plotting phase. This is because:

1. Step 5 (test_correlation.py) creates diagnostic plots as PART of the analysis
2. Plots are simple diagnostic visualizations (histogram + Q-Q plot)
3. No separate plot source CSVs needed - plots generated from step04 random effects

PLOTS ALREADY CREATED (by step05_test_correlation.py):
- plots/step05_random_slopes_histogram.png
  -> Histogram of random slopes distribution with normal overlay
  -> Created using matplotlib/seaborn during Step 5 execution

- plots/step05_random_slopes_qqplot.png
  -> Q-Q plot assessing normality of random slopes distribution
  -> Created using scipy.stats.probplot during Step 5 execution

ARCHITECTURE RATIONALE:

RQ 5.13 differs from typical trajectory RQs (which follow Option B architecture):
- Trajectory RQs: Complex plots requiring aggregated plot source CSVs
- RQ 5.13: Simple diagnostic plots embedded in analysis step

This approach is acceptable because:
1. Plots are tightly coupled to correlation test (Step 5 analysis)
2. No reusability across RQs (specific to RQ 5.13 random effects)
3. No Decision D069 requirement (not trajectory plots)
4. Simpler than creating intermediate plot source CSVs

VALIDATION:

rq_inspect verifies:
- Both PNG files exist in plots/ folder
- File sizes > 10 KB (non-empty plots)
- Created during step05 execution (timestamp check)

NO ACTION REQUIRED: Plots already exist, no new generation needed.
"""

from pathlib import Path

# Get absolute path to RQ root
RQ_ROOT = Path(__file__).parent.parent

print("=" * 70)
print("RQ 5.13 PLOTTING - SPECIAL CASE")
print("=" * 70)
print()
print("Plots for RQ 5.13 were created DURING analysis execution (Step 5),")
print("NOT in a separate plotting phase.")
print()
print("Existing plots:")
print("  - plots/step05_random_slopes_histogram.png")
print("  - plots/step05_random_slopes_qqplot.png")
print()
print("Both plots were generated by code/step05_test_correlation.py")
print("as part of the correlation test and normality assessment.")
print()
print("NO NEW PLOTS GENERATED - plots already exist.")
print("=" * 70)

# Verify plots exist
histogram_path = RQ_ROOT / "plots" / "step05_random_slopes_histogram.png"
qqplot_path = RQ_ROOT / "plots" / "step05_random_slopes_qqplot.png"

if histogram_path.exists() and qqplot_path.exists():
    print()
    print("VALIDATION: PASS")
    print(f"  - Histogram exists: {histogram_path}")
    print(f"  - Q-Q plot exists: {qqplot_path}")
    print()
    print("All expected plots present. No action required.")
else:
    print()
    print("VALIDATION: FAIL")
    if not histogram_path.exists():
        print(f"  - Missing: {histogram_path}")
    if not qqplot_path.exists():
        print(f"  - Missing: {qqplot_path}")
    print()
    print("ERROR: Expected plots missing. Re-run step05_test_correlation.py")

print("=" * 70)
