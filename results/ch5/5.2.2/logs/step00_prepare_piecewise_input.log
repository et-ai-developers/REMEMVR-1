[START] Step 00: Prepare Piecewise LMM Input from RQ 5.1
[CONFIG] RQ Directory: /home/etai/projects/REMEMVR/results/ch5/rq2
[CONFIG] Input: /home/etai/projects/REMEMVR/results/ch5/rq1/data/step04_lmm_input.csv
[CONFIG] Output: /home/etai/projects/REMEMVR/results/ch5/rq2/data/step00_piecewise_lmm_input.csv
[VALIDATE] Checking RQ 5.1 dependency...
[PASS] RQ 5.1 dependency exists: /home/etai/projects/REMEMVR/results/ch5/rq1/data/step04_lmm_input.csv
[LOAD] Loading RQ 5.1 LMM input data...
[LOADED] step04_lmm_input.csv (1200 rows, 6 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta']
[PASS] All required columns present: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta']
[TRANSFORM] Creating Segment variable...
[INFO] Segment assignment by test:
       test=1 -> Segment=Early (n=300)
       test=2 -> Segment=Early (n=300)
       test=3 -> Segment=Late (n=300)
       test=4 -> Segment=Late (n=300)
[PASS] Segment assignment complete: no NaN values
[TRANSFORM] Creating Days_within variable...
[INFO] Min TSVR for Late segment: 61.28 hours
[INFO] Days_within statistics by segment:
       Early: min=0.04, max=2.99, mean=0.62
       Late: min=0.00, max=7.71, mean=2.24
[VALIDATE] Running validation checks...
[PASS] Row count preserved: 1200
[PASS] Segment assignment correct: test 0,1 -> Early; test 3,6 -> Late
[PASS] No NaN values in Segment or Days_within
[PASS] Days_within range valid: Early max=2.99, Late max=7.71
[PASS] All domains present: {'what', 'when', 'where'}
[SAVE] Saving piecewise LMM input...
[SAVED] /home/etai/projects/REMEMVR/results/ch5/rq2/data/step00_piecewise_lmm_input.csv (1200 rows, 8 cols)
[INFO] Output columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta', 'Segment', 'Days_within']

======================================================================
[SUCCESS] Step 00 complete: Piecewise LMM Input Prepared
======================================================================
  Input:  /home/etai/projects/REMEMVR/results/ch5/rq1/data/step04_lmm_input.csv
  Output: /home/etai/projects/REMEMVR/results/ch5/rq2/data/step00_piecewise_lmm_input.csv
  Rows:   1200

  Segment distribution:
    - Early: 600 rows (50.0%)
    - Late: 600 rows (50.0%)

  Next step: step01_fit_piecewise_lmm.py
======================================================================
[START] Step 00: Prepare Piecewise LMM Input from RQ 5.1
[CONFIG] RQ Directory: /home/etai/projects/REMEMVR/results/ch5/5.2.2
[CONFIG] Input: /home/etai/projects/REMEMVR/results/ch5/5.1.1/data/step04_lmm_input.csv
[CONFIG] Output: /home/etai/projects/REMEMVR/results/ch5/5.2.2/data/step00_piecewise_lmm_input.csv
[VALIDATE] Checking RQ 5.1 dependency...
[PASS] RQ 5.1 dependency exists: /home/etai/projects/REMEMVR/results/ch5/5.1.1/data/step04_lmm_input.csv
[LOAD] Loading RQ 5.1 LMM input data...
[LOADED] step04_lmm_input.csv (400 rows, 9 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'Theta', 'SE', 'TSVR_hours', 'Days', 'Days_squared', 'log_Days_plus1']
[ERROR] CRITICAL: Missing required columns: ['domain', 'theta']
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.2.2/code/step00_prepare_piecewise_input.py", line 169, in <module>
    raise ValueError(f"CRITICAL: Missing required columns: {missing_cols}")
ValueError: CRITICAL: Missing required columns: ['domain', 'theta']
[START] Step 00: Prepare Piecewise LMM Input from RQ 5.2.1
[CONFIG] RQ Directory: /home/etai/projects/REMEMVR/results/ch5/5.2.2
[CONFIG] Input: /home/etai/projects/REMEMVR/results/ch5/5.2.1/data/step04_lmm_input.csv
[CONFIG] Output: /home/etai/projects/REMEMVR/results/ch5/5.2.2/data/step00_piecewise_lmm_input.csv
[VALIDATE] Checking RQ 5.2.1 dependency...
[PASS] RQ 5.2.1 dependency exists: /home/etai/projects/REMEMVR/results/ch5/5.2.1/data/step04_lmm_input.csv
[LOAD] Loading RQ 5.2.1 LMM input data...
[LOADED] step04_lmm_input.csv (1200 rows, 6 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta']
[PASS] All required columns present: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta']
[FILTER] Excluding When domain (floor effect per RQ 5.2.1)...
[INFO] Original domains: ['what', 'where', 'when']
[INFO] Original row count: 1200
[INFO] After filter - domains: ['what', 'where']
[INFO] After filter - row count: 800
[INFO] Rows removed (When domain): 400
[PASS] When domain excluded successfully
[TRANSFORM] Creating Segment variable...
[INFO] Segment assignment by test:
       test=1 -> Segment=Early (n=200)
       test=3 -> Segment=Late (n=200)
[ERROR] CRITICAL: 400 rows have NaN Segment values. Unexpected test values found: [2 4]
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.2.2/code/step00_prepare_piecewise_input.py", line 229, in <module>
    raise ValueError(
ValueError: CRITICAL: 400 rows have NaN Segment values. Unexpected test values found: [2 4]
[START] Step 00: Prepare Piecewise LMM Input from RQ 5.2.1
[CONFIG] RQ Directory: /home/etai/projects/REMEMVR/results/ch5/5.2.2
[CONFIG] Input: /home/etai/projects/REMEMVR/results/ch5/5.2.1/data/step04_lmm_input.csv
[CONFIG] Output: /home/etai/projects/REMEMVR/results/ch5/5.2.2/data/step00_piecewise_lmm_input.csv
[VALIDATE] Checking RQ 5.2.1 dependency...
[PASS] RQ 5.2.1 dependency exists: /home/etai/projects/REMEMVR/results/ch5/5.2.1/data/step04_lmm_input.csv
[LOAD] Loading RQ 5.2.1 LMM input data...
[LOADED] step04_lmm_input.csv (1200 rows, 6 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta']
[PASS] All required columns present: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta']
[FILTER] Excluding When domain (floor effect per RQ 5.2.1)...
[INFO] Original domains: ['what', 'where', 'when']
[INFO] Original row count: 1200
[INFO] After filter - domains: ['what', 'where']
[INFO] After filter - row count: 800
[INFO] Rows removed (When domain): 400
[PASS] When domain excluded successfully
[TRANSFORM] Creating Segment variable...
[INFO] Segment assignment by test:
       test=1 -> Segment=Early (n=200)
       test=2 -> Segment=Early (n=200)
       test=3 -> Segment=Late (n=200)
       test=4 -> Segment=Late (n=200)
[PASS] Segment assignment complete: no NaN values
[TRANSFORM] Creating Days_within variable...
[INFO] Min TSVR for Late segment: 61.28 hours
[INFO] Days_within statistics by segment:
       Early: min=0.04, max=2.99, mean=0.62
       Late: min=0.00, max=7.71, mean=2.24
[VALIDATE] Running validation checks...
[PASS] Row count preserved (after When filter): 800
[PASS] Segment assignment correct: test 1,2 -> Early; test 3,4 -> Late
[PASS] No NaN values in Segment or Days_within
[PASS] Days_within range valid: Early max=2.99, Late max=7.71
[PASS] Expected domains present (When excluded): {'what', 'where'}
[SAVE] Saving piecewise LMM input...
[SAVED] /home/etai/projects/REMEMVR/results/ch5/5.2.2/data/step00_piecewise_lmm_input.csv (800 rows, 8 cols)
[INFO] Output columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta', 'Segment', 'Days_within']

======================================================================
[SUCCESS] Step 00 complete: Piecewise LMM Input Prepared
======================================================================
  Input:  /home/etai/projects/REMEMVR/results/ch5/5.2.1/data/step04_lmm_input.csv
  Output: /home/etai/projects/REMEMVR/results/ch5/5.2.2/data/step00_piecewise_lmm_input.csv
  Rows:   800

  Segment distribution:
    - Early: 400 rows (50.0%)
    - Late: 400 rows (50.0%)

  Next step: step01_fit_piecewise_lmm.py
======================================================================
