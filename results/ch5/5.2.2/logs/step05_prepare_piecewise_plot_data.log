[START] Step 05: Prepare Piecewise Trajectory Plot Data
============================================================
[LOAD] Loading input data...
[LOADED] step00_piecewise_lmm_input.csv (1200 rows, 8 cols)
         Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta', 'Segment', 'Days_within']
[LOADED] step01_piecewise_lmm_model.pkl (MixedLMResults object)
[LOADED] RQ 5.1 step03_item_parameters.csv (69 items)
         Mean item discrimination (a): 0.9490

[ANALYSIS] Aggregating theta scores by domain, test, and Segment...
[DONE] Aggregated to 12 groups (domain x test combinations)

[ANALYSIS] Generating model predictions for trajectory lines...
[DONE] Generated 12 predictions

[SAVE] Saving theta-scale plot data...
[SAVED] plots/step05_piecewise_theta_data.csv (12 rows)
         Theta range: [-0.462, 0.648]

[ANALYSIS] Transforming theta to probability scale (Decision D069)...
         Using IRT 2PL: P = 1 / (1 + exp(-(a * (theta - b))))
         a = 0.9490 (mean discrimination)
         b = 0.0 (reference difficulty)
[DONE] Transformed 12 rows to probability scale
         Probability range: [0.392, 0.649]

[SAVE] Saving probability-scale plot data...
[SAVED] plots/step05_piecewise_probability_data.csv (12 rows)

[VALIDATION] Running validation checks...
[PASS] Theta plot data has exactly 12 rows
[PASS] Probability plot data has exactly 12 rows
[PASS] All domains present: {what, where, when}
[PASS] All tests present: {1, 2, 3, 4}
[PASS] Segment assignment correct: T1,T2 -> 'Early'; T3,T4 -> 'Late'
[PASS] Theta range valid: [-0.462, 0.648]
[PASS] Probability range valid: [0.392, 0.649]
[PASS] Theta CI structure valid: CI_lower < mean < CI_upper
[PASS] Probability CI structure valid: CI_lower < mean < CI_upper
[PASS] No NaN values in output data

[SUCCESS] All validation checks passed!

============================================================
[SUMMARY] Step 05 Complete
============================================================
Outputs:
  - plots/step05_piecewise_theta_data.csv (12 rows)
  - plots/step05_piecewise_probability_data.csv (12 rows)

Decision D069 Implementation:
  - Theta scale: For psychometricians and statistical rigor
  - Probability scale: For general audience interpretability
  - Transformation: IRT 2PL with a=0.9490, b=0

[SUCCESS] Step 05 complete
[START] Step 05: Prepare Piecewise Trajectory Plot Data
============================================================
[LOAD] Loading input data...
[LOADED] step00_piecewise_lmm_input.csv (800 rows, 8 cols)
         Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours', 'domain', 'theta', 'Segment', 'Days_within']
[LOADED] step01_piecewise_lmm_model.pkl (MixedLMResults object)
[LOADED] RQ 5.2.1 step03_item_parameters.csv (69 items)
         Mean item discrimination (a): 0.9490

[ANALYSIS] Aggregating theta scores by domain, test, and Segment...
[DONE] Aggregated to 8 groups (domain x test combinations)

[ANALYSIS] Generating model predictions for trajectory lines...
[DONE] Generated 8 predictions

[SAVE] Saving theta-scale plot data...
[SAVED] plots/step05_piecewise_theta_data.csv (8 rows)
         Theta range: [-0.462, 0.648]

[ANALYSIS] Transforming theta to probability scale (Decision D069)...
         Using IRT 2PL: P = 1 / (1 + exp(-(a * (theta - b))))
         a = 0.9490 (mean discrimination)
         b = 0.0 (reference difficulty)
[DONE] Transformed 8 rows to probability scale
         Probability range: [0.392, 0.649]

[SAVE] Saving probability-scale plot data...
[SAVED] plots/step05_piecewise_probability_data.csv (8 rows)

[VALIDATION] Running validation checks...
[PASS] Theta plot data has exactly 8 rows (When excluded)
[PASS] Probability plot data has exactly 8 rows (When excluded)
[PASS] All domains present: {what, where} (When excluded)
[PASS] All tests present: {1, 2, 3, 4}
[PASS] Segment assignment correct: T1,T2 -> 'Early'; T3,T4 -> 'Late'
[PASS] Theta range valid: [-0.462, 0.648]
[PASS] Probability range valid: [0.392, 0.649]
[PASS] Theta CI structure valid: CI_lower < mean < CI_upper
[PASS] Probability CI structure valid: CI_lower < mean < CI_upper
[PASS] No NaN values in output data

[SUCCESS] All validation checks passed!

============================================================
[SUMMARY] Step 05 Complete
============================================================
Outputs:
  - plots/step05_piecewise_theta_data.csv (8 rows)
  - plots/step05_piecewise_probability_data.csv (8 rows)

Decision D069 Implementation:
  - Theta scale: For psychometricians and statistical rigor
  - Probability scale: For general audience interpretability
  - Transformation: IRT 2PL with a=0.9490, b=0

[SUCCESS] Step 05 complete
