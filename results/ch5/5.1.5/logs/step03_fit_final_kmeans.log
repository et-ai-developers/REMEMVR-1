[START] Step 03: Fit Final K-means Model with Optimal K
[LOAD] Loading standardized features...
[LOADED] standardized_features (100 rows, 3 cols)
[INFO] Feature matrix shape: (100, 2)
[LOAD] Reading optimal K from Step 2...
[INFO] Optimal K from Step 2 (BIC minimum): K_initial = 2
[ANALYSIS] Starting K-means fitting with K=2...
[INFO] Min cluster size threshold: 10 (10% of N=100)
[FIT] Fitting K-means with K=2 (random_state=42, n_init=50)...
[INFO] Cluster sizes (K=2): {np.int32(0): np.int64(69), np.int32(1): np.int64(31)}
[PASS] All clusters meet size threshold (min size = 31 >= 10)
[DONE] Final K-means fit complete with K_final = 2
[EXTRACT] Extracting cluster assignments...
[INFO] Cluster assignments shape: (100, 2)
[EXTRACT] Extracting cluster centers...
[INFO] Cluster centers shape: (2, 3)
[SAVE] Saving cluster assignments to data/step03_cluster_assignments.csv...
[SAVED] step03_cluster_assignments.csv (100 rows, 2 cols)
[SAVE] Saving cluster centers to data/step03_cluster_centers.csv...
[SAVED] step03_cluster_centers.csv (2 rows, 3 cols)
[VALIDATION] Running validate_cluster_assignment...
[VALIDATION] PASS - Valid cluster assignment: 2 clusters, sizes {0: 69, 1: 31}
[VALIDATION] Cluster sizes: {0: 69, 1: 31}
[SUCCESS] Step 03 complete - K_final=2, all clusters meet size threshold
[START] Step 03: Fit Final K-means Model with Optimal K
[LOAD] Loading standardized features...
[LOADED] standardized_features (100 rows, 3 cols)
[INFO] Feature matrix shape: (100, 2)
[LOAD] Reading optimal K from Step 2...
[INFO] Optimal K from Step 2 (BIC minimum): K_initial = 3
[ANALYSIS] Starting K-means fitting with K=3...
[INFO] Min cluster size threshold: 10 (10% of N=100)
[FIT] Fitting K-means with K=3 (random_state=42, n_init=50)...
[INFO] Cluster sizes (K=3): {np.int32(0): np.int64(25), np.int32(1): np.int64(44), np.int32(2): np.int64(31)}
[PASS] All clusters meet size threshold (min size = 25 >= 10)
[DONE] Final K-means fit complete with K_final = 3
[EXTRACT] Extracting cluster assignments...
[INFO] Cluster assignments shape: (100, 2)
[EXTRACT] Extracting cluster centers...
[INFO] Cluster centers shape: (3, 3)
[SAVE] Saving cluster assignments to data/step03_cluster_assignments.csv...
[SAVED] step03_cluster_assignments.csv (100 rows, 2 cols)
[SAVE] Saving cluster centers to data/step03_cluster_centers.csv...
[SAVED] step03_cluster_centers.csv (3 rows, 3 cols)
[VALIDATION] Running validate_cluster_assignment...
[VALIDATION] PASS - Valid cluster assignment: 3 clusters, sizes {1: 44, 2: 31, 0: 25}
[VALIDATION] Cluster sizes: {1: 44, 2: 31, 0: 25}
[SUCCESS] Step 03 complete - K_final=3, all clusters meet size threshold
