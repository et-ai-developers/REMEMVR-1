[START] Step 06: Compare ICC Across Locations
[LOAD] Loading ICC estimates from Step 3...
[LOADED] step03_icc_estimates.csv (6 rows, 4 cols)
[FILTER] Separating Source and Destination ICC estimates...
[FILTERED] Source: 3 rows, Destination: 3 rows
[MERGE] Merging Source and Destination on icc_type...
[MERGED] Combined table: 3 rows
[COMPUTE] Computing difference (source_value - destination_value)...
[COMPUTED] Difference column added
[INTERPRET] Generating interpretation strings...
[INTERPRETED] Interpretation column added
[SELECT] Selecting output columns...
[SELECTED] Final output: 3 rows, 5 cols
[SAVE] Saving ICC comparison table...
[SAVED] step06_location_icc_comparison.csv (3 rows, 5 cols)
[VALIDATION] Running validate_dataframe_structure...
[ERROR] data type 'o' not understood
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.5.6/code/step06_compare_icc_across_locations.py", line 274, in <module>
    validation_result = validate_dataframe_structure(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/tools/validation.py", line 2838, in validate_dataframe_structure
    if not any(actual_type == exp_type or np.issubdtype(actual_type, exp_type) for exp_type in expected_types):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/tools/validation.py", line 2838, in <genexpr>
    if not any(actual_type == exp_type or np.issubdtype(actual_type, exp_type) for exp_type in expected_types):
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/numpy/_core/numerictypes.py", line 536, in issubdtype
    arg2 = dtype(arg2).type
           ^^^^^^^^^^^
TypeError: data type 'o' not understood
[START] Step 06: Compare ICC Across Locations
[LOAD] Loading ICC estimates from Step 3...
[LOADED] step03_icc_estimates.csv (6 rows, 4 cols)
[FILTER] Separating Source and Destination ICC estimates...
[FILTERED] Source: 3 rows, Destination: 3 rows
[MERGE] Merging Source and Destination on icc_type...
[MERGED] Combined table: 3 rows
[COMPUTE] Computing difference (source_value - destination_value)...
[COMPUTED] Difference column added
[INTERPRET] Generating interpretation strings...
[INTERPRETED] Interpretation column added
[SELECT] Selecting output columns...
[SELECTED] Final output: 3 rows, 5 cols
[SAVE] Saving ICC comparison table...
[SAVED] step06_location_icc_comparison.csv (3 rows, 5 cols)
[VALIDATION] Checking output structure...
[VALIDATION] PASS - Row count: 3
[VALIDATION] PASS - All expected columns present
[VALIDATION] Checking ICC value bounds...
[VALIDATION] PASS - source_value in [0, 1]
[VALIDATION] PASS - destination_value in [0, 1]
[VALIDATION] PASS - difference correctly computed
[VALIDATION] PASS - No NaN values

[SUMMARY] ICC Comparison Results:
============================================================
ICC_intercept:
  Source:      0.2400
  Destination: 0.4211
  Difference:  -0.1811
  Destination shows substantially higher baseline stability than Source

ICC_slope_conditional:
  Source:      0.4080
  Destination: 0.1669
  Difference:  +0.2411
  Difference in slope variance: 0.2411 (both near zero)

ICC_slope_simple:
  Source:      0.0051
  Destination: 0.0216
  Difference:  -0.0165
  Difference in slope variance: -0.0165 (both near zero)

[PRIMARY COMPARISON] ICC_intercept (baseline stability):
  Source:      0.2400
  Destination: 0.4211
  Difference:  -0.1811
  -> Destination shows HIGHER baseline stability (contradicts hypothesis)

[SUCCESS] Step 06 complete
