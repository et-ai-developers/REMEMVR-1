[2025-12-08 13:15:28] ================================================================================
[2025-12-08 13:15:28] LMM Model Selection: Kitchen Sink Suite
[2025-12-08 13:15:28] ================================================================================
[2025-12-08 13:15:28] [VALIDATION] Checking inputs...
[2025-12-08 13:15:28]   TSVR variable: TSVR_hours
[2025-12-08 13:15:28]   TSVR range: [1.00, 246.24] hours
[2025-12-08 13:15:28]   TSVR unique values: 295
[2025-12-08 13:15:28]   Outcome: theta
[2025-12-08 13:15:28]   Groups: UID (N=100)
[2025-12-08 13:15:28]   N observations: 800
[2025-12-08 13:15:28]   Factor 1: LocationType (categorical, ref=source)
[2025-12-08 13:15:28]   Interaction: 1-way (time × factor1)
[2025-12-08 13:15:28]   Random effects: ~1
[2025-12-08 13:15:28]   REML: False
[2025-12-08 13:15:28] [TRANSFORM] Creating time transformations...
[2025-12-08 13:15:28]   Polynomial family...
[2025-12-08 13:15:28]   Logarithmic family...
[2025-12-08 13:15:28]   Power law family...
[2025-12-08 13:15:28]   Root family...
[2025-12-08 13:15:28]   Reciprocal family...
[2025-12-08 13:15:28]   Exponential family...
[2025-12-08 13:15:28]   Trigonometric family...
[2025-12-08 13:15:28]   Hyperbolic family...
[2025-12-08 13:15:28]   Total transformations created: 32
[2025-12-08 13:15:28] [CONFIG] Defining model suite...
[2025-12-08 13:15:28]   Total models defined: 66
[2025-12-08 13:15:28] [FORMULA] Building model formulas...
[2025-12-08 13:15:28]   Example formula (Linear): theta ~ TSVR * C(LocationType, Treatment('source'))
[2025-12-08 13:15:28]   Example formula (Log): theta ~ log_TSVR * C(LocationType, Treatment('source'))
[2025-12-08 13:15:28] [ANALYSIS] Fitting all models...
[2025-12-08 13:15:28]   This may take 5-10 minutes for 66 models...
[2025-12-08 13:15:28]   [1/66] Fitting Linear...
[2025-12-08 13:15:28]     ✓ AIC=1761.61, converged=True
[2025-12-08 13:15:28]   [2/66] Fitting Quadratic...
[2025-12-08 13:15:28]     ✓ AIC=1750.80, converged=True
[2025-12-08 13:15:28]   [3/66] Fitting Cubic...
[2025-12-08 13:15:28]     ✓ AIC=1753.56, converged=True
[2025-12-08 13:15:28]   [4/66] Fitting Quartic...
[2025-12-08 13:15:28]     ✓ AIC=1755.11, converged=True
[2025-12-08 13:15:28]   [5/66] Fitting Quadratic_pure...
[2025-12-08 13:15:29]     ✓ AIC=1798.54, converged=True
[2025-12-08 13:15:29]   [6/66] Fitting Cubic_pure...
[2025-12-08 13:15:29]     ✓ AIC=1830.85, converged=True
[2025-12-08 13:15:29]   [7/66] Fitting Log...
[2025-12-08 13:15:29]     ✓ AIC=1751.15, converged=True
[2025-12-08 13:15:29]   [8/66] Fitting Log2...
[2025-12-08 13:15:29]     ✓ AIC=1751.15, converged=True
[2025-12-08 13:15:29]   [9/66] Fitting Log10...
[2025-12-08 13:15:29]     ✓ AIC=1751.15, converged=True
[2025-12-08 13:15:29]   [10/66] Fitting LogLog...
[2025-12-08 13:15:29]     ✓ AIC=1757.24, converged=True
[2025-12-08 13:15:29]   [11/66] Fitting Lin+Log...
[2025-12-08 13:15:30]     ✓ AIC=1753.11, converged=True
[2025-12-08 13:15:30]   [12/66] Fitting Quad+Log...
[2025-12-08 13:15:30]     ✓ AIC=1753.88, converged=True
[2025-12-08 13:15:30]   [13/66] Fitting Log+LogLog...
[2025-12-08 13:15:30]     ✓ AIC=1753.84, converged=True
[2025-12-08 13:15:30]   [14/66] Fitting Lin+Quad+Log...
[2025-12-08 13:15:30]     ✓ AIC=1753.88, converged=True
[2025-12-08 13:15:30]   [15/66] Fitting PowerLaw_01...
[2025-12-08 13:15:31]     ✓ AIC=1751.69, converged=True
[2025-12-08 13:15:31]   [16/66] Fitting PowerLaw_02...
[2025-12-08 13:15:31]     ✓ AIC=1752.53, converged=True
[2025-12-08 13:15:31]   [17/66] Fitting PowerLaw_03...
[2025-12-08 13:15:31]     ✓ AIC=1753.63, converged=True
[2025-12-08 13:15:31]   [18/66] Fitting PowerLaw_04...
[2025-12-08 13:15:31]     ✓ AIC=1754.98, converged=True
[2025-12-08 13:15:31]   [19/66] Fitting PowerLaw_05...
[2025-12-08 13:15:31]     ✓ AIC=1756.55, converged=True
[2025-12-08 13:15:31]   [20/66] Fitting PowerLaw_06...
[2025-12-08 13:15:32]     ✓ AIC=1758.30, converged=True
[2025-12-08 13:15:32]   [21/66] Fitting PowerLaw_07...
[2025-12-08 13:15:32]     ✓ AIC=1760.22, converged=True
[2025-12-08 13:15:32]   [22/66] Fitting PowerLaw_08...
[2025-12-08 13:15:32]     ✓ AIC=1762.26, converged=True
[2025-12-08 13:15:32]   [23/66] Fitting PowerLaw_09...
[2025-12-08 13:15:32]     ✓ AIC=1764.41, converged=True
[2025-12-08 13:15:32]   [24/66] Fitting PowerLaw_10...
[2025-12-08 13:15:33]     ✓ AIC=1766.62, converged=True
[2025-12-08 13:15:33]   [25/66] Fitting PowerLaw_Log...
[2025-12-08 13:15:33]     ✓ AIC=1753.01, converged=True
[2025-12-08 13:15:33]   [26/66] Fitting PowerLaw_Lin...
[2025-12-08 13:15:33]     ✓ AIC=1752.47, converged=True
[2025-12-08 13:15:33]   [27/66] Fitting SquareRoot...
[2025-12-08 13:15:33]     ✓ AIC=1751.50, converged=True
[2025-12-08 13:15:33]   [28/66] Fitting CubeRoot...
[2025-12-08 13:15:33]     ✓ AIC=1754.61, converged=True
[2025-12-08 13:15:33]   [29/66] Fitting FourthRoot...
[2025-12-08 13:15:34]     ✓ AIC=1757.79, converged=True
[2025-12-08 13:15:34]   [30/66] Fitting Root_033...
[2025-12-08 13:15:34]     ✓ AIC=1754.62, converged=True
[2025-12-08 13:15:34]   [31/66] Fitting Root_067...
[2025-12-08 13:15:34]     ✓ AIC=1752.41, converged=True
[2025-12-08 13:15:34]   [32/66] Fitting SquareRoot+Log...
[2025-12-08 13:15:34]     ✓ AIC=1753.12, converged=True
[2025-12-08 13:15:34]   [33/66] Fitting CubeRoot+Log...
[2025-12-08 13:15:34]     ✓ AIC=1752.97, converged=True
[2025-12-08 13:15:34]   [34/66] Fitting SquareRoot+Lin...
[2025-12-08 13:15:34]     ✓ AIC=1752.46, converged=True
[2025-12-08 13:15:34]   [35/66] Fitting Root_Multi...
[2025-12-08 13:15:35]     ✓ AIC=1754.06, converged=True
[2025-12-08 13:15:35]   [36/66] Fitting Reciprocal...
[2025-12-08 13:15:35]     ✓ AIC=1766.62, converged=True
[2025-12-08 13:15:35]   [37/66] Fitting Recip+Log...
[2025-12-08 13:15:35]     ✓ AIC=1753.00, converged=True
[2025-12-08 13:15:35]   [38/66] Fitting Recip+Lin...
[2025-12-08 13:15:35]     ✓ AIC=1752.96, converged=True
[2025-12-08 13:15:35]   [39/66] Fitting Recip+Quad...
[2025-12-08 13:15:35]     ✓ AIC=1752.61, converged=True
[2025-12-08 13:15:35]   [40/66] Fitting Recip_sq...
[2025-12-08 13:15:36]     ✓ AIC=1787.94, converged=True
[2025-12-08 13:15:36]   [41/66] Fitting Recip+PowerLaw...
[2025-12-08 13:15:36]     ✓ AIC=1753.70, converged=True
[2025-12-08 13:15:36]   [42/66] Fitting Exponential_proxy...
[2025-12-08 13:15:36]     ✓ AIC=1761.61, converged=True
[2025-12-08 13:15:36]   [43/66] Fitting Exp+Log...
[2025-12-08 13:15:36]     ✓ AIC=1753.11, converged=True
[2025-12-08 13:15:36]   [44/66] Fitting Exp+Lin...
[2025-12-08 13:15:36]     ✗ FAILED: Singular matrix
[2025-12-08 13:15:36]   [45/66] Fitting Exp_fast...
[2025-12-08 13:15:36]     ✓ AIC=1798.54, converged=True
[2025-12-08 13:15:36]   [46/66] Fitting Exp_slow...
[2025-12-08 13:15:37]     ✓ AIC=1751.50, converged=True
[2025-12-08 13:15:37]   [47/66] Fitting Exp+PowerLaw...
[2025-12-08 13:15:37]     ✓ AIC=1754.37, converged=True
[2025-12-08 13:15:37]   [48/66] Fitting Exp+Recip...
[2025-12-08 13:15:37]     ✓ AIC=1755.59, converged=True
[2025-12-08 13:15:37]   [49/66] Fitting Sin...
[2025-12-08 13:15:37]     ✓ AIC=1895.36, converged=True
[2025-12-08 13:15:37]   [50/66] Fitting Cos...
[2025-12-08 13:15:37]     ✓ AIC=1765.93, converged=True
[2025-12-08 13:15:37]   [51/66] Fitting Sin+Cos...
[2025-12-08 13:15:37]     ✓ AIC=1767.49, converged=True
[2025-12-08 13:15:37]   [52/66] Fitting Sin+Log...
[2025-12-08 13:15:38]     ✓ AIC=1752.70, converged=True
[2025-12-08 13:15:38]   [53/66] Fitting Tanh...
[2025-12-08 13:15:38]     ✓ AIC=1756.68, converged=True
[2025-12-08 13:15:38]   [54/66] Fitting Tanh+Log...
[2025-12-08 13:15:38]     ✓ AIC=1753.01, converged=True
[2025-12-08 13:15:38]   [55/66] Fitting Arctanh...
[2025-12-08 13:15:38]     ✓ AIC=1794.73, converged=True
[2025-12-08 13:15:38]   [56/66] Fitting Sinh...
[2025-12-08 13:15:38]     ✓ AIC=1765.10, converged=True
[2025-12-08 13:15:38]   [57/66] Fitting Log+PowerLaw05...
[2025-12-08 13:15:39]     ✓ AIC=1753.80, converged=True
[2025-12-08 13:15:39]   [58/66] Fitting Log+SquareRoot...
[2025-12-08 13:15:39]     ✓ AIC=1753.05, converged=True
[2025-12-08 13:15:39]   [59/66] Fitting Log+Recip...
[2025-12-08 13:15:39]     ✓ AIC=1754.53, converged=True
[2025-12-08 13:15:39]   [60/66] Fitting SquareRoot+PowerLaw...
[2025-12-08 13:15:39]     ✓ AIC=1754.36, converged=True
[2025-12-08 13:15:39]   [61/66] Fitting SquareRoot+Recip...
[2025-12-08 13:15:39]     ✓ AIC=1755.08, converged=True
[2025-12-08 13:15:39]   [62/66] Fitting Recip+PowerLaw05...
[2025-12-08 13:15:40]     ✓ AIC=1753.70, converged=True
[2025-12-08 13:15:40]   [63/66] Fitting Lin+Log+PowerLaw...
[2025-12-08 13:15:40]     ✓ AIC=1755.44, converged=True
[2025-12-08 13:15:40]   [64/66] Fitting Quad+Log+SquareRoot...
[2025-12-08 13:15:40]     ✓ AIC=1755.01, converged=True
[2025-12-08 13:15:40]   [65/66] Fitting PowerLaw+Recip+Log...
[2025-12-08 13:15:40]     ✓ AIC=1754.92, converged=True
[2025-12-08 13:15:40]   [66/66] Fitting Ultimate...
[2025-12-08 13:15:40]     ✓ AIC=1759.09, converged=True
[2025-12-08 13:15:40]   Successful fits: 65/66
[2025-12-08 13:15:40]   Failed fits: 1
[2025-12-08 13:15:40] [COMPUTE] Computing AIC comparison metrics...
[2025-12-08 13:15:40]   Minimum AIC: 1750.80
[2025-12-08 13:15:40]   delta_AIC range: [0.00, 144.55]
[2025-12-08 13:15:40]   Akaike weight sum: 1.000000 (should be 1.0)
[2025-12-08 13:15:40] [RESULTS] Identifying best model...
[2025-12-08 13:15:40]   Best model: Quadratic
[2025-12-08 13:15:40]   AIC: 1750.80
[2025-12-08 13:15:40]   Akaike weight: 0.0670 (6.7%)
[2025-12-08 13:15:40]   Uncertainty: High (<30% probability - weak support, consider model averaging)
[2025-12-08 13:15:40]   Log model (benchmark): Rank #2, AIC=1751.15, Δ=0.34, weight=0.0564
[2025-12-08 13:15:40] [VALIDATION] Validating AIC comparison metrics...
[2025-12-08 13:15:40]   ✓ Akaike weights sum to 1.0 (1.000000)
[2025-12-08 13:15:40]   ✓ All Akaike weights in (0, 1)
[2025-12-08 13:15:40]   ✓ Best model has delta_AIC = 0
[2025-12-08 13:15:40]   ✓ cumulative_weight monotonic increasing
[2025-12-08 13:15:40]   ✓ cumulative_weight ends at 1.0 (1.000000)
[2025-12-08 13:15:40] [OUTPUT] Preparing output dictionary...
[2025-12-08 13:15:40]   Competitive models (ΔAIC < 2): 13
[2025-12-08 13:15:40] [SAVE] Saving outputs to /home/etai/projects/REMEMVR/results/ch5/5.5.1/data...
[2025-12-08 13:15:40]   ✓ model_comparison.csv
[2025-12-08 13:15:40]   ✓ best_model_summary.txt[DONE] Kitchen sink comparison complete
[RESULTS] Model comparison summary:
================================================================================
TOP 10 MODELS (out of 65):
--------------------------------------------------------------------------------
[ERROR] Step 05 failed
  KeyError: 'rank'
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'rank'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.5.1/code/step05_fit_extended_lmm_models.py", line 163, in <module>
    log(f"  {row['rank']:2d}. {row['model_name']:25s} "
             ~~~^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/series.py", line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/series.py", line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'rank'

