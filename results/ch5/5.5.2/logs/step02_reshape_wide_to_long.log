[START] Step 02: Reshape Wide to Long
[LOAD] Loading wide-format data from Step 1...
[LOADED] step01_piecewise_time_variables.csv (400 rows, 10 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'theta_source', 'theta_destination', 'se_source', 'se_destination', 'TSVR_hours', 'Segment', 'Days_within']
[ANALYSIS] Reshaping from wide to long format...
[INFO] After melt: 800 rows
[PROCESSING] Creating LocationType factor...
[INFO] LocationType distribution:
LocationType
Source         400
Destination    400
Name: count, dtype: int64
[PROCESSING] Matching SE values to theta...
[INFO] SE range: [0.500, 0.500]
[PROCESSING] Finalizing column structure...
[INFO] Final columns: ['UID', 'test', 'LocationType', 'theta', 'se', 'TSVR_hours', 'Segment', 'Days_within']
[SAVE] Saving long-format LMM input...
[SAVED] step02_lmm_input_long.csv (800 rows, 8 cols)
[VALIDATION] Running validate_data_format()...
[VALIDATION] All required columns present (8 columns). DataFrame has 800 rows.
[VALIDATION] Performing additional data quality checks...
[PASS] Row count: 800 (expected 800)
[PASS] LocationType distribution: 400 Source, 400 Destination
[PASS] Each UID x test appears exactly 2 times
[PASS] No NaN values in any column
[PASS] Theta range: [-1.868, 2.251] (within [-3, 3])
[PASS] SE range: [0.500, 0.500] (within [0.1, 1.0])
[SUCCESS] Step 02 complete - wide-to-long reshape successful
