[START] Step 3: Fit Parallel LMMs (IRT-based and CTT-based)
[LOAD] Loading IRT theta scores...
[LOADED] step00_irt_theta_from_rq551.csv (800 rows, 7 cols)
[INFO] IRT theta range: [-1.87, 2.25]
[LOAD] Loading CTT mean scores...
[LOADED] step01_ctt_scores.csv (800 rows, 7 cols)
[INFO] CTT score range: [0.100, 1.000]
[PREP] Creating log_TSVR transformation...
[PREP] log_TSVR range (IRT): [0.693, 5.510]
[PREP] log_TSVR range (CTT): [0.693, 5.510]
[VALIDATE] Checking data integrity...
[VALIDATE] Data integrity checks passed
[ANALYSIS] Fitting IRT-based LMM with full random structure...
[INFO] Formula: irt_theta ~ C(location_type, Treatment('source')) * log_TSVR
[INFO] Random: ~log_TSVR (random intercepts + slopes for TSVR)
[INFO] Groups: UID
[INFO] REML: False (for AIC comparison)
[FIT] IRT model (full) convergence: True
[ANALYSIS] Fitting CTT-based LMM with full random structure...
[INFO] Formula: ctt_mean_score ~ C(location_type, Treatment('source')) * log_TSVR
[INFO] Random: ~log_TSVR (random intercepts + slopes for TSVR)
[INFO] Groups: UID
[INFO] REML: False (for AIC comparison)
[FIT] CTT model (full) convergence: True
[SUCCESS] Both models converged with full random structure
[EXTRACT] Extracting fixed effects from IRT model...
[ERROR] All arrays must be of the same length
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.5.4/code/step03_fit_parallel_lmms.py", line 309, in <module>
    irt_coef_df = pd.DataFrame({
                  ^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/frame.py", line 782, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/internals/construction.py", line 114, in arrays_to_mgr
    index = _extract_index(arrays)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/pandas/core/internals/construction.py", line 677, in _extract_index
    raise ValueError("All arrays must be of the same length")
ValueError: All arrays must be of the same length
[START] Step 3: Fit Parallel LMMs (IRT-based and CTT-based)
[LOAD] Loading IRT theta scores...
[LOADED] step00_irt_theta_from_rq551.csv (800 rows, 7 cols)
[INFO] IRT theta range: [-1.87, 2.25]
[LOAD] Loading CTT mean scores...
[LOADED] step01_ctt_scores.csv (800 rows, 7 cols)
[INFO] CTT score range: [0.100, 1.000]
[PREP] Creating log_TSVR transformation...
[PREP] log_TSVR range (IRT): [0.693, 5.510]
[PREP] log_TSVR range (CTT): [0.693, 5.510]
[VALIDATE] Checking data integrity...
[VALIDATE] Data integrity checks passed
[ANALYSIS] Fitting IRT-based LMM with full random structure...
[INFO] Formula: irt_theta ~ C(location_type, Treatment('source')) * log_TSVR
[INFO] Random: ~log_TSVR (random intercepts + slopes for TSVR)
[INFO] Groups: UID
[INFO] REML: False (for AIC comparison)
[FIT] IRT model (full) convergence: True
[ANALYSIS] Fitting CTT-based LMM with full random structure...
[INFO] Formula: ctt_mean_score ~ C(location_type, Treatment('source')) * log_TSVR
[INFO] Random: ~log_TSVR (random intercepts + slopes for TSVR)
[INFO] Groups: UID
[INFO] REML: False (for AIC comparison)
[FIT] CTT model (full) convergence: True
[SUCCESS] Both models converged with full random structure
[EXTRACT] Extracting fixed effects from IRT model...
[INFO] IRT model: 4 fixed effects
[EXTRACT] Extracting fixed effects from CTT model...
[INFO] CTT model: 4 fixed effects
[SAVE] Saving IRT model...
[SAVED] data/step03_irt_lmm_model.pkl
[SAVE] Saving CTT model...
[SAVED] data/step03_ctt_lmm_model.pkl
[SAVE] Saving IRT model summary...
[SAVED] data/step03_irt_lmm_summary.txt
[SAVE] Saving CTT model summary...
[SAVED] data/step03_ctt_lmm_summary.txt
[SAVE] Saving IRT fixed effects table...
[SAVED] data/step03_irt_coefficients.csv (4 rows)
[SAVE] Saving CTT fixed effects table...
[SAVED] data/step03_ctt_coefficients.csv (4 rows)
[SAVE] Creating model metadata...
[SAVED] data/step03_model_metadata.yaml
[VALIDATION] Running validation checks...
[VALIDATION] IRT model convergence: Model converged successfully.
[VALIDATION] CTT model convergence: Model converged successfully.
[VALIDATION] IRT model AIC=1764.26, BIC=1801.73
[VALIDATION] CTT model AIC=-685.18, BIC=-647.71
[VALIDATION] Both models have 4 fixed effects (Intercept, LocationType, log_TSVR, interaction)
[VALIDATION] All validation checks passed:
  [PASS] IRT model converged
  [PASS] CTT model converged
  [PASS] Both models have identical random structure (symmetric)
  [PASS] AIC and BIC are finite for both models
  [PASS] Both models have 4 fixed effects
[SUCCESS] Step 3 complete
[INFO] Random structure: Full (~log_TSVR)
[INFO] Next: Run step04_validate_lmm_assumptions.py
