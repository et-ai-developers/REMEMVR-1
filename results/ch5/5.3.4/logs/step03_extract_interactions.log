[START] Step 03: Extract 3-Way Interaction Terms
[LOAD] Loading LMM model from Step 2...
[LOADED] LMM model from /home/etai/projects/REMEMVR/results/ch5/5.3.4/data/step02_lmm_model.pkl
[INFO] Model has 18 fixed effects parameters
[ANALYSIS] Extracting fixed effects table...
[DONE] Extracted 21 fixed effects
[FILTER] Identifying 3-way interaction terms...
[FILTERED] Found 0 three-way interaction terms
[ERROR] Missing interaction terms: {"log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]", "log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]", "TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]", "TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]"}
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.3.4/code/step03_extract_interactions.py", line 193, in <module>
    raise ValueError(f"Missing interaction terms: {missing}")
ValueError: Missing interaction terms: {"log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]", "log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]", "TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]", "TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]"}
[START] Step 03: Extract 3-Way Interaction Terms
[LOAD] Loading LMM model from Step 2...
[ERROR] 'NoneType' object has no attribute 'f_locals'
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.3.4/code/step03_extract_interactions.py", line 74, in <module>
    lmm_model = pickle.load(f)
                ^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/statsmodels/base/data.py", line 112, in __setstate__
    _, design = dmatrices(d['formula'], data, eval_env=depth,
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/patsy/highlevel.py", line 316, in dmatrices
    eval_env = EvalEnvironment.capture(eval_env, reference=1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/etai/projects/REMEMVR/.venv/lib/python3.12/site-packages/patsy/eval.py", line 242, in capture
    [frame.f_locals, frame.f_globals],
     ^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'f_locals'
[START] Step 03: Extract 3-Way Interaction Terms
[LOAD] Loading fixed effects from Step 2...
[LOADED] 18 fixed effects from /home/etai/projects/REMEMVR/results/ch5/5.3.4/data/step02_fixed_effects.csv
[INFO] All fixed effect terms:
  Intercept
  C(paradigm, Treatment('IFR'))[T.ICR]
  C(paradigm, Treatment('IFR'))[T.IRE]
  TSVR_hours
  TSVR_hours:C(paradigm, Treatment('IFR'))[T.ICR]
  TSVR_hours:C(paradigm, Treatment('IFR'))[T.IRE]
  log_TSVR
  log_TSVR:C(paradigm, Treatment('IFR'))[T.ICR]
  log_TSVR:C(paradigm, Treatment('IFR'))[T.IRE]
  Age_c
  Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
  Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
  TSVR_hours:Age_c
  TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
  TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
  log_TSVR:Age_c
  log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
  log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
[FILTER] Identifying 3-way interaction terms...
[FILTERED] Found 4 three-way interaction terms
  Found: TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
  Found: TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
  Found: log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
  Found: log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
[BONFERRONI] Applying Bonferroni correction for 2 time transformations...
[INFO] Bonferroni multiplier: 2
[INFO] Family-wise alpha: 0.025
[RESULTS] 3-Way Interaction Terms:
  TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
    coef=0.000031, SE=0.000080, z=0.386
    p_uncorrected=0.6997, p_bonferroni=1.0000
  TSVR_hours:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
    coef=-0.000018, SE=0.000080, z=-0.232
    p_uncorrected=0.8169, p_bonferroni=1.0000
  log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.ICR]
    coef=-0.001044, SE=0.002788, z=-0.374
    p_uncorrected=0.7081, p_bonferroni=1.0000
  log_TSVR:Age_c:C(paradigm, Treatment('IFR'))[T.IRE]
    coef=0.000743, SE=0.002788, z=0.266
    p_uncorrected=0.7900, p_bonferroni=1.0000
[SAVE] Saving interaction terms...
[SAVED] /home/etai/projects/REMEMVR/results/ch5/5.3.4/data/step03_interaction_terms.csv
[INFO] Saved 4 interaction terms with 7 columns
[VALIDATION] Checking output format...
[PASS] Row count: 4 three-way interaction terms
[PASS] Column count: 7 columns
[PASS] Dual p-values present (Decision D068 compliance)
[PASS] No NaN values
[INFO] Significant at Bonferroni alpha=0.025: 0 of 4 terms
[SUCCESS] Step 03 complete
[SUMMARY]
  Extracted: 4 three-way interaction terms
  Bonferroni correction: Ã— 2
  Significant (p_bonferroni < 0.025): 0
  Output: data/step03_interaction_terms.csv
  Ready for Step 4 (compute age effects and post-hoc contrasts)
