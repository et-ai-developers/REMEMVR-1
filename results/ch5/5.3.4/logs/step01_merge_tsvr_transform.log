[START] Step 01: Merge TSVR and Transform Variables
[LOAD] Loading Step 0 theta-age merged data...
[LOADED] step00_theta_age_merged.csv (1200 rows, 6 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'paradigm', 'theta', 'Age']
[LOAD] Loading TSVR mapping from RQ 5.3.1...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours']
[INFO] Merge strategy: UID + test (TSVR has no paradigm dimension, must replicate across paradigms)
[MERGE] Merging theta-age with TSVR on (UID, test)...
[MERGED] Result: 1200 rows, 7 cols
[PASS] Merge successful - all 1200 theta observations have TSVR_hours
[TRANSFORM] Creating Age_c (grand-mean centered)...
[INFO] Age mean: 44.570
[INFO] Age_c mean: 0.000000 (should be ~0)
[INFO] Age SD: 14.512
[INFO] Age_c SD: 14.512 (should equal Age SD)
[PASS] Age_c grand-mean centered (mean = 0.000000)
[PASS] Age_c preserves variance (SD = 14.512)
[TRANSFORM] Creating log_TSVR (log transformation)...
[INFO] log_TSVR range: [0.693, 5.510]
[INFO] Expected range: [0.0, ~5.13] (log(0+1)=0, log(168+1)~5.13)
[ERROR] log_TSVR maximum exceeds expected: 5.510 > 5.2
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.3.4/code/step01_merge_tsvr_transform.py", line 240, in <module>
    raise ValueError(f"log_TSVR maximum exceeds expected: {df_merged['log_TSVR'].max():.3f} > 5.2")
ValueError: log_TSVR maximum exceeds expected: 5.510 > 5.2
[START] Step 01: Merge TSVR and Transform Variables
[LOAD] Loading Step 0 theta-age merged data...
[LOADED] step00_theta_age_merged.csv (1200 rows, 6 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'paradigm', 'theta', 'Age']
[LOAD] Loading TSVR mapping from RQ 5.3.1...
[LOADED] step00_tsvr_mapping.csv (400 rows, 4 cols)
[INFO] Columns: ['composite_ID', 'UID', 'test', 'TSVR_hours']
[INFO] Merge strategy: UID + test (TSVR has no paradigm dimension, must replicate across paradigms)
[MERGE] Merging theta-age with TSVR on (UID, test)...
[MERGED] Result: 1200 rows, 7 cols
[PASS] Merge successful - all 1200 theta observations have TSVR_hours
[TRANSFORM] Creating Age_c (grand-mean centered)...
[INFO] Age mean: 44.570
[INFO] Age_c mean: 0.000000 (should be ~0)
[INFO] Age SD: 14.512
[INFO] Age_c SD: 14.512 (should equal Age SD)
[PASS] Age_c grand-mean centered (mean = 0.000000)
[PASS] Age_c preserves variance (SD = 14.512)
[TRANSFORM] Creating log_TSVR (log transformation)...
[INFO] log_TSVR range: [0.693, 5.510]
[INFO] TSVR_hours range: [1.0, 246.2] hours
[PASS] log_TSVR range valid (transformation successful)
[VALIDATE] Checking log_TSVR monotonicity...
[INFO] log(0 + 1) = 0.000
[INFO] log(1 + 1) = 0.693
[INFO] log(24 + 1) = 3.219
[INFO] log(72 + 1) = 4.290
[INFO] log(144 + 1) = 4.977
[INFO] log(168 + 1) = 5.130
[PASS] log_TSVR transformation correct
[VALIDATE] Checking for missing values...
[PASS] No missing values in merged dataset
[VALIDATE] Checking value ranges...
[INFO] theta range: [-2.406, 2.799]
[INFO] Age range: [20.0, 70.0]
[PASS] Age range valid
[INFO] TSVR_hours range: [1.00, 246.24]
[PASS] TSVR_hours range valid
[INFO] Paradigms: ['IFR', 'ICR', 'IRE']
[INFO] Paradigm counts:
  IFR: 400 observations
  ICR: 400 observations
  IRE: 400 observations
[PASS] Paradigm balance validated (400 observations per paradigm)
[INFO] Unique participants: 100
[PASS] All 100 participants present
[SAVE] Saving LMM input data...
[SAVED] step01_lmm_input.csv (1200 rows, 9 cols)
[INFO] Output columns: ['composite_ID', 'UID', 'test', 'paradigm', 'theta', 'Age', 'Age_c', 'TSVR_hours', 'log_TSVR']
[VALIDATE] Verifying saved file...
[PASS] Output file validated
[SUCCESS] Step 01 complete
[SUMMARY]
  Input: 1200 theta-age observations + 400 TSVR observations
  Merge: UID + test (replicated TSVR across 3 paradigms)
  Age_c: Grand-mean centered (mean = 0.000000)
  log_TSVR: Log-transformed time (range [0.693, 5.510])
  Output: 1200 rows x 9 columns
  Ready for LMM analysis (Step 2)
