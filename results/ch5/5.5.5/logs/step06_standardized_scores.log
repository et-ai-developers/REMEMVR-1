[START] Step 6: Z-Standardize All Measurements
[LOAD] Loading IRT theta scores from RQ 5.5.1...
[LOADED] step03_theta_scores.csv (400 rows, 5 cols)
[INFO] Theta columns: ['composite_ID', 'theta_source', 'theta_destination', 'se_source', 'se_destination']
[LOAD] Loading Full CTT scores from Step 2...
[LOADED] step02_ctt_full_scores.csv (800 rows, 4 cols)
[LOAD] Loading Purified CTT scores from Step 3...
[LOADED] step03_ctt_purified_scores.csv (800 rows, 4 cols)
[TRANSFORM] Parsing composite_ID into UID and test...
[INFO] Parsed 400 composite_IDs
[TRANSFORM] Reshaping theta to long format...
[TRANSFORMED] Theta reshaped to long format (800 rows)
[INFO] Theta location_type counts: {'source': 400, 'destination': 400}
[MERGE] Merging theta with Full CTT...
[MERGED] After Full CTT merge: 0 rows
[MERGE] Merging with Purified CTT...
[MERGED] After Purified CTT merge: 0 rows
[ERROR] Expected 800 rows after merge, got 0
[ERROR] Merge produced 0 rows, expected 800
[TRACEBACK] Full error details:
Traceback (most recent call last):
  File "/home/etai/projects/REMEMVR/results/ch5/5.5.5/code/step06_standardized_scores.py", line 220, in <module>
    raise ValueError(f"Merge produced {len(merged_df)} rows, expected 800")
ValueError: Merge produced 0 rows, expected 800
[START] Step 6: Z-Standardize All Measurements
[LOAD] Loading IRT theta scores from RQ 5.5.1...
[LOADED] step03_theta_scores.csv (400 rows, 5 cols)
[INFO] Theta columns: ['composite_ID', 'theta_source', 'theta_destination', 'se_source', 'se_destination']
[LOAD] Loading Full CTT scores from Step 2...
[LOADED] step02_ctt_full_scores.csv (800 rows, 4 cols)
[LOAD] Loading Purified CTT scores from Step 3...
[LOADED] step03_ctt_purified_scores.csv (800 rows, 4 cols)
[TRANSFORM] Parsing composite_ID into UID and test...
[INFO] Parsed 400 composite_IDs
[INFO] Test values: ['T1', 'T2', 'T3', 'T4']
[TRANSFORM] Reshaping theta to long format...
[TRANSFORMED] Theta reshaped to long format (800 rows)
[INFO] Theta location_type counts: {'source': 400, 'destination': 400}
[MERGE] Merging theta with Full CTT...
[MERGED] After Full CTT merge: 800 rows
[MERGE] Merging with Purified CTT...
[MERGED] After Purified CTT merge: 800 rows
[INFO] Merged columns: ['UID', 'test', 'theta', 'location_type', 'ctt_full_score', 'ctt_purified_score']
[INFO] Missing values: {'UID': 0, 'test': 0, 'theta': 0, 'location_type': 0, 'ctt_full_score': 0, 'ctt_purified_score': 0}
[STANDARDIZE] Z-standardizing measurements within location_type...
[INFO] Using sample std (ddof=1) for consistency with LMM estimation
[STANDARDIZED] IRT theta -> irt_z
[STANDARDIZED] Full CTT -> ctt_full_z
[STANDARDIZED] Purified CTT -> ctt_purified_z
[VALIDATION] Validating z-score standardization...

[VALIDATION] Location type: source
  [PASS] irt_z: mean=0.000000, std=1.000000
  [PASS] ctt_full_z: mean=-0.000000, std=1.000000
  [PASS] ctt_purified_z: mean=-0.000000, std=1.000000

[VALIDATION] Location type: destination
  [PASS] irt_z: mean=0.000000, std=1.000000
  [PASS] ctt_full_z: mean=0.000000, std=1.000000
  [PASS] ctt_purified_z: mean=0.000000, std=1.000000

[VALIDATION] All z-scores validated: mean ≈ 0, std ≈ 1
[VALIDATION] No NaN values in z-score columns
[SAVE] Saving standardized scores...
[SAVED] step06_standardized_scores.csv (800 rows, 6 cols)

[SUMMARY] Step 6 Complete:
  Input files: 3 (theta, full_ctt, purified_ctt)
  Output rows: 800
  Location types: 2
  Participants: 100
  Test sessions: 4
  Z-score columns: 3
  Validation: All z-scores have mean ≈ 0, std ≈ 1 per location_type
[SUCCESS] Step 6 complete
