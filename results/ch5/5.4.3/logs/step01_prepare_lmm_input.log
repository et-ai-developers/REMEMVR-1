[START] Step 01: Merge Data and Prepare LMM Input

[STEP 1] Load Input Files
----------------------------------------------------------------------
[LOADED] Theta wide: 400 rows, 7 columns
[LOADED] TSVR mapping: 400 rows, 4 columns
[LOADED] Age data: 100 rows, 2 columns

[STEP 2] Merge Theta with TSVR Mapping
----------------------------------------------------------------------
[MERGED] Theta + TSVR: 400 rows
[PASS] Merge successful, no NaN values introduced

[STEP 3] Merge with Age Data
----------------------------------------------------------------------
[MERGED] Theta + TSVR + Age: 400 rows
[PASS] Merge successful, no NaN values introduced
[INFO] Columns after merge: ['composite_ID', 'theta_common', 'theta_congruent', 'theta_incongruent', 'se_common', 'se_congruent', 'se_incongruent', 'UID', 'test', 'TSVR_hours', 'Age']

[STEP 4] Reshape Wide to Long Format
----------------------------------------------------------------------
[RESHAPED] Long format: 1200 rows
[INFO] Expected: 1200 rows (400 x 3 congruence levels)
[PASS] Row count correct: 1200

[STEP 5] Grand-Mean Center Age
----------------------------------------------------------------------
[INFO] Age mean across 100 participants: 44.57
[INFO] Age SD across 100 participants: 14.58
[INFO] Age_c mean across participants: 0.0000
[PASS] Age_c mean within +/- 0.1 of 0: 0.0000

[STEP 6] Create Time Transformations
----------------------------------------------------------------------
[INFO] TSVR_hours range: [1.00, 246.24]
[CREATED] log_TSVR = log(TSVR_hours + 1)
[INFO] log_TSVR range: [0.69, 5.51]

[STEP 7] Final Validation
----------------------------------------------------------------------
[PASS] No NaN values in any column
[PASS] Congruence levels correct: ['Common', 'Congruent', 'Incongruent']
[PASS] Each UID appears exactly 12 times (4 tests x 3 congruence)

[STEP 8] Save Output
----------------------------------------------------------------------
[SAVED] /home/etai/projects/REMEMVR/results/ch5/5.4.3/data/step01_lmm_input.csv
  1200 rows, 10 columns

[SUMMARY]
----------------------------------------------------------------------
Input files:
  Theta wide: 400 rows
  TSVR mapping: 400 rows
  Age data: 100 rows

Output file:
  LMM input: 1200 rows x 10 columns

Transformations applied:
  - Reshaped wide -> long format
  - Grand-mean centered Age (Age_c)
  - Created log(TSVR_hours + 1)

Value ranges:
  theta: [-2.15, 2.34]
  Age: [20, 70]
  Age_c: [-24.57, 25.43]
  TSVR_hours: [1.00, 246.24]
  log_TSVR: [0.69, 5.51]

[SUCCESS] Step 01 complete - LMM input prepared
