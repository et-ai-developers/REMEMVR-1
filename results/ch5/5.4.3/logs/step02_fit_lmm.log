[START] Step 02: Fit LMM with 3-Way Interaction

[STEP 1] Load LMM Input Data
----------------------------------------------------------------------
[LOADED] LMM input: 1200 rows, 11 columns
[INFO] Columns: ['UID', 'composite_ID', 'test', 'congruence', 'theta', 'se_theta', 'Age', 'Age_c', 'TSVR_hours', 'recip_TSVR', 'log_TSVR']
[INFO] Unique UIDs: 100
[INFO] Congruence levels: ['Common', 'Congruent', 'Incongruent']

[STEP 2] Create Dummy Variables for Congruence
----------------------------------------------------------------------
[CREATED] Dummy variables: Congruent, Incongruent (reference: Common)
[INFO] Congruent sum: 400 (expected: 400)
[INFO] Incongruent sum: 400 (expected: 400)

[STEP 3] Fit LMM Model
----------------------------------------------------------------------
[INFO] Model formula (fixed effects - Recip+Log two-process):
  theta ~ 1 + recip_TSVR + log_TSVR + Age_c + Congruent + Incongruent
        + Age_c:recip_TSVR + Age_c:log_TSVR
        + Congruent:recip_TSVR + Congruent:log_TSVR
        + Incongruent:recip_TSVR + Incongruent:log_TSVR
        + Age_c:Congruent + Age_c:Incongruent
        + Age_c:Congruent:recip_TSVR + Age_c:Congruent:log_TSVR
        + Age_c:Incongruent:recip_TSVR + Age_c:Incongruent:log_TSVR

[INFO] Random effects: ~recip_TSVR | UID (per RQ 5.4.1 ROOT Recip+Log model)
[INFO] Two-process forgetting: rapid 1/(t+1) + slow log(t+1)

[INFO] Fitting model (this may take a moment)...
[SUCCESS] Model fitted with random slopes on recip_TSVR (two-process forgetting)
[INFO] Model converged: True

[STEP 4] Extract Fixed Effects
----------------------------------------------------------------------
[INFO] Model summary available
[EXTRACTED] Fixed effects: 18 terms

[INFO] Fixed Effects Table:
----------------------------------------------------------------------
  Intercept                                coef=  1.2882 SE=0.2603 p=0.0000*
  recip_TSVR                               coef= -1.2111 SE=0.4705 p=0.0101*
  log_TSVR                                 coef= -0.3348 SE=0.0575 p=0.0000*
  Age_c                                    coef= -0.0003 SE=0.0177 p=0.9885
  Congruent                                coef=  0.0581 SE=0.3607 p=0.8721
  Incongruent                              coef= -0.0841 SE=0.3607 p=0.8156
  Age_c:recip_TSVR                         coef= -0.0140 SE=0.0320 p=0.6607
  Age_c:log_TSVR                           coef= -0.0014 SE=0.0039 p=0.7276
  Congruent:recip_TSVR                     coef= -0.1681 SE=0.6426 p=0.7937
  Congruent:log_TSVR                       coef= -0.0044 SE=0.0811 p=0.9565
  Incongruent:recip_TSVR                   coef=  0.2495 SE=0.6426 p=0.6978
  Incongruent:log_TSVR                     coef=  0.0189 SE=0.0811 p=0.8155
  Age_c:Congruent                          coef=  0.0373 SE=0.0245 p=0.1275
  Age_c:Incongruent                        coef= -0.0155 SE=0.0245 p=0.5259
  Age_c:Congruent:recip_TSVR               coef= -0.0671 SE=0.0437 p=0.1243
  Age_c:Congruent:log_TSVR                 coef= -0.0074 SE=0.0055 p=0.1788
  Age_c:Incongruent:recip_TSVR             coef=  0.0223 SE=0.0437 p=0.6091
  Age_c:Incongruent:log_TSVR               coef=  0.0035 SE=0.0055 p=0.5259

[STEP 5] Model Diagnostics
----------------------------------------------------------------------
[INFO] Log-Likelihood: -1300.23
[INFO] AIC: nan
[INFO] BIC: nan

[INFO] Random Effects:
  Group Var (UID): 0.2339
  TSVR_hours Var: 1.3891
  Covariance: -0.1671
  Residual Var: 0.3637

[INFO] Sample Size:
  Observations: 1200
  Groups (UIDs): 100

[STEP 6] Validate LMM Assumptions (Basic Checks)
----------------------------------------------------------------------
[CHECK] Residual mean: -0.000000 (should be ~0)
[PASS] Residual mean approximately zero
[INFO] Residual SD: 0.5592
[CHECK] Observations with |residual| > 3 SD: 3
[PASS] Few extreme residuals (<1% of observations)

[STEP 7] Save Outputs
----------------------------------------------------------------------
[SAVED] Fixed effects: /home/etai/projects/REMEMVR/results/ch5/5.4.3/data/step02_fixed_effects.csv
  18 rows, 5 columns
[SAVED] Model summary: /home/etai/projects/REMEMVR/results/ch5/5.4.3/data/step02_lmm_model_summary.txt
[SAVED] Model object: /home/etai/projects/REMEMVR/results/ch5/5.4.3/data/step02_lmm_model.pkl

[SUMMARY]
----------------------------------------------------------------------
Model: 3-way Age x Congruence x Time LMM
Random Structure: random intercepts + slopes for recip_TSVR (per 5.4.1 ROOT)
Converged: True

Fixed Effects: 18 terms
  - Main effects: Intercept, TSVR_hours, log_TSVR, Age_c, Congruent, Incongruent
  - 2-way interactions: Age_c x Time, Congruence x Time, Age_c x Congruence
  - 3-way interactions: Age_c x Congruence x Time (4 terms)

Model Fit:
  Log-Likelihood: -1300.23
  AIC: nan
  BIC: nan

[KEY FINDINGS] 3-Way Interaction Terms:
  Age_c:Congruent:recip_TSVR: p=0.1243 (not significant)
  Age_c:Congruent:log_TSVR: p=0.1788 (not significant)
  Age_c:Incongruent:recip_TSVR: p=0.6091 (not significant)
  Age_c:Incongruent:log_TSVR: p=0.5259 (not significant)

[SUCCESS] Step 02 complete - LMM model fitted
